"strict";function ready(e){"loading"!==document.readyState?e():document.addEventListener("DOMContentLoaded",e)}function productionServer(){return window.location.href.indexOf("fourtonfish.com")>-1}function removeClasses(e){e.className=""}function getEventTarget(e){return e=e||window.event,e.target||e.srcElement}function getRandomInt(e,t){return Math.floor(Math.random()*(t-e+1))+e}window.smoothScroll=function(){if(void 0!==document.querySelectorAll&&void 0!==window.pageYOffset&&void 0!==history.pushState){var e=function(e){return"HTML"===e.nodeName?-window.pageYOffset:e.getBoundingClientRect().top+window.pageYOffset},t=function(e){return.5>e?4*e*e*e:(e-1)*(2*e-2)*(2*e-2)+1},o=function(e,o,n,s){return n>s?o:e+(o-e)*t(n/s)},n=function(t,n,s){n=n||500;var a,r=window.pageYOffset;a="number"==typeof t?parseInt(t):e(t);var i=Date.now(),l=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||function(e){window.setTimeout(e,15)},u=function(){var e=Date.now()-i;window.scroll(0,o(r,a,e,n)),e>n?"function"==typeof s&&s(t):l(u)};u()},s=function(e){e.preventDefault(),n(document.getElementById(this.hash.substring(1)),500,function(){})};return document.addEventListener("DOMContentLoaded",function(){for(var e,t=document.querySelectorAll('a[href^="#"]'),o=t.length;e=t[--o];)e.addEventListener("click",s,!1)}),n}}();var xmlToJSON=function(e){var t=new X2JS,o=t.xml_str2json(e);return o=o.response},userRole,partnerRole="unknown",gameStarted=!1,gameFinished=!1;window.onbeforeunload=function(){return gameFinished===!1?"Are you sure?":void 0},ready(function(){function e(e,t){return e=e.toLowerCase().trim().replace(/ /g,""),t===!0&&(e=e.replace(/[.,?!\s,]/g,"")),e}function t(e){for(var t=0,o=x.length;o>t;t++)if(new RegExp(x[t],"gi").test(e.replace(/\W/g,""))===!0)return c("system","ERROR"),c("system","Unable to send message"),!0;return!1}function o(){B.service=d.getAttribute("data-service"),console.log(B.service);var e="Play Detective, a game by @fourtonfish";null!==B.service&&"reddit"===B.service&&(e="[log] TITLE"),B.shareUrl=d.getAttribute("data-url").replace(/DESCRIPTION/,'Detective: A "reverse Turing test" chat game.').replace(/CHATLOGURL/gi,"http://fourtonfish.com/detective/log?id="+B.chatLogId).replace(/SHORTTITLE/,e),B.status.innerHTML="",window.open(B.shareUrl)}function n(){clearTimeout(g),g=setTimeout(function(){i()},getRandomInt(3e4,6e4))}function s(e){if(H.useLessClever===!0&&"..."!==e){e=e.toLowerCase().replace(/^(i )| i /gi," I ").trim();var t=e.replace(/([.?!])\s*(?=[A-Z])/,"$1|").split("|");1===t.length&&(e=e.replace(/\.$/,"")),5===getRandomInt(1,10)&&(e=e.replace(/(')/gi,""))}switch(getRandomInt(1,1e4)){case"1":e=e.replace("ll","l");break;case"2":e=e.replace("ss","s");break;case"3":e=e.replace("l","k");break;case"4":e=e.replace("o","p");break;case"4":e=e.replace("w","s");break;case"5":e=e.replace("s","d")}return e}function a(){C.style.display="block",Array.prototype.forEach.call(document.getElementsByClassName("share-link-shifted"),function(e,t){setTimeout(function(){e.classList.remove("share-link-shifted"),e.classList.add("share-link-unshifted")},10*t*t)})}function r(t){if(-1===H.alreadyAnswered.indexOf(e(t,!0))){"..."!==t&&H.alreadyAnswered.push(e(t,!0));var o=new XMLHttpRequest;o.open("GET","//www.botlibre.com/rest/botlibre/form-chat?instance="+H.id+"&application=155525030417300595&message="+t+(null!==H.conversationID?"&conversation="+H.conversationID:""),!0),o.onload=function(){if(o.status>=200&&o.status<400){var e=xmlToJSON(o.responseText);null===H.conversationID&&(H.conversationID=e._conversation),void 0===e.message?i():new RegExp(D.join("|")).test(e.message)===!0?r(t):l(s(e.message))}else console.log("ERROR"),console.log(o.responseText),alert("ERROR: "+o.responseText+"\n\nPlease contact stefan@fourtonfish.com.\n\nThanks!")},o.onerror=function(){},o.send()}else if(t.indexOf("?")>-1)if(H.alreadyAnsweredResponses.length>0){var n=H.alreadyAnsweredResponses.splice(getRandomInt(0,H.alreadyAnsweredResponses.length-1),1);n=n[0],l(s(n))}else l("...")}function i(){var e=["..."];r(e[getRandomInt(0,e.length-1)])}function l(e){if(e=e.replace(/(RobotNotImpostor(\d)*|Jenny|linh truong|Alice)/gi,H.name),e=e.replace(/ROBOTFROM/gi,H.from),H.pendingResponses.push(e),H.pendingResponses.length>0){var t=H.pendingResponses.shift(),o=t.length,n=o*getRandomInt(50,100)+getRandomInt(2e3,8e3);H.responsePending===!1?(H.responsePending=!0,setTimeout(function(){c("robot",e),H.responsePending=!1},n)):setTimeout(function(){return function(e){l(e)}(e)},1e3)}}function u(e){"unknown"!==partnerRole?(gameFinished=!0,e===partnerRole?(c("system","CORRECT"),m.emit("game over","detective won")):(c("system","INCORRECT"),m.emit("game over","detective lost")),c("system","Game is over"),a()):(c("system","ERROR"),c("system","Too early to tell"))}function c(t,o){if(0===o.trim().length)return!1;var n=document.createElement("LI");switch(t){case"user":n.classList.add("user-message"),n.classList.add("new-message");break;case"system":switch(n.classList.add("system-message"),o){case"ERROR":case"INCORRECT":n.classList.add("error-message");break;case"CORRECT":n.classList.add("user-correct");break;default:n.classList.add("new-message")}break;case"robot":case"impostor":n.classList.add("rori-message"),n.classList.add("new-message")}var s=e(o,!0);if(s.indexOf("wiggle")>-1&&n.classList.add("wiggle-message"),s.indexOf("jump")>-1&&n.classList.add("jump-message"),n.innerHTML=o.replace(/(<([^>]+)>)/gi,""),"user"!==t&&"system"!==t&&(n.innerHTML='<span class="message-prepend">></span> '+n.innerHTML),"Game is over"===o&&"system"===t&&(n.innerHTML+='<p style="color: #fff !important;">PS: This game is now <a target="_blank" href="https://github.com/botwiki/detective/">open source</a>!</p>'),"robot"===t&&gameFinished===!0);else switch(O.appendChild(n),e(o,!0)){case"ilikethisgame":c("system","Oh hey, thanks!");break;case"godmode":c("system","Not in this game.")}"user"===t?k.value="":document.hasFocus()||(document.title="New message | Detective by @fourtonfish"),document.body.scrollTop=document.body.scrollHeight,window.scrollTo(0,document.body.scrollHeight),o=e(o,!1),"user"===t&&/you.*re?.*(impostor|imposter|robot|bot)/gi.test(o)&&"detective"===userRole&&gameFinished===!1&&-1===o.indexOf("not")&&(console.log(o),new RegExp(["youarearobot","you'rearobot","youarerobot","yourerobot","yourearobot","you'rerobot","youaretherobot","you'retherobot"].join("|")).test(o)===!0?u("robot"):new RegExp(["youareanimposter","youareanimpostor","you'reanimposter","you'reanimpostor","youareimposter","youareimpostor","you'reimposter","you'reimpostor","youretheimposter","youretheimpostor","youreimposter","youreimpostor","youreanimposter","youreanimpostor","youaretheimposter","youaretheimpostor","you'retheimposter","you'retheimpostor"].join("|")).test(o)===!0?u("impostor"):c("system",'Please say "You are a robot" or "You are an impostor".'))}var d,m,g,h=document.getElementsByClassName("shifted-1"),p=document.getElementsByClassName("shifted"),y=document.getElementById("loading"),f=document.getElementById("you-are"),v=document.getElementById("instructions-wrapper"),w=document.getElementById("instructions"),R=document.getElementById("dismiss-instructions"),b=document.getElementById("more-info"),E=document.getElementById("role-reminder"),L=document.getElementById("message-form"),T=document.getElementById("send-message"),k=document.getElementById("message-text"),I=document.getElementById("messages-wrapper"),O=document.getElementById("messages"),C=document.getElementById("share-chat-log-wrapper"),B=(document.getElementById("what-is-this"),{triggerEl:document.getElementById("share-buttons-game"),service:null,status:document.getElementById("chat-log-url-status"),shareUrl:null,chatLogId:null}),A=["909409"],M=["your mom","not your business","none of your business","Steve","Bob","Lucy","Rita","Cletus","Rufus","Gale","Sidney","Emmie","Ethyl","Babara","Jodie","Karon","Rashida","Olen","Felisa","Nenita","Camille","Shay","Phoebe","Angelique","Monte","Exie","Lucrecia","Melodi","Marge","Zoe","Cassandra","Rosaura","Brendon","Mckinley","Lucie","Shandi","Mao","Vilma","Shara","Giselle","Royal","Dia","Ivy","Sheridan","Kandi","Juliette","Camilla","Susanna","Gary","Gertha","Britany","Marvella","Sina","Lakeesha","Sherill","Toney","Sherri","Albertina","Taren","Hildred","Erma","Lenard","Tyson","Markus","Inez","Letty","Deedra","Tammera","Stanley","Lora","Leon","Belkis","Janae","Lenna","Bronwyn","Kimbery","Debi","Bernie","Alleen","Deloise","Chiquita","Shanelle","Wynona","Kisha","Minna","Laronda","Chaya","Anabel","Leila","Arletha","Loyce","Crysta","Maegan","Valery","Hee","Ed","Mitsuko","Vincenzo","Mercedez","Janeen","Fredrick","Sharda","Dylan","Cassi","Mae","Bobbye","Lanny"],S=["Uh, where are you from?","That's prvivate.","Your mom!","I live right next to you!","...","I'm homeless","I'm homeless?"],D=["beeyotch","biatch","bitch","chinaman","chinamen","chink","crip","cunt","dago","daygo","dego","dick","douchebag","dyke","fag","fatass","fatso","gash","gimp","golliwog","gook","gyp","homo","hooker","jap","kike","kraut","lame","lardass","lesbo","negro","nigga","nigger","paki","pickaninny","pussy","raghead","retard","shemale","skank","slut","spade","spic","spook","tard","tits","titt","trannies","tranny","twat","wetback","whore","wop"],H={id:A[getRandomInt(0,A.length-1)],name:M[getRandomInt(0,M.length-1)],from:S[getRandomInt(0,S.length-1)],conversationID:null,useLessClever:Math.random()<.5?!0:!1,responsePending:!1,pendingResponses:[],alreadyAnswered:[],alreadyAnsweredResponses:["You already asked that question.","You already asked me that.","I think I already told you.","I already told you.","I already answered that.","Did you read my answer?","You already said that.","...","I told you","I literally just told you.","I just told you."]},x=["n(i|1)+g{2,}((e|3)+r+|a)+","f+a+g+","f+(a|@)+g{2,}(o|0)+t+"],Y=setTimeout(function(){gameStarted===!1&&(y.innerHTML="Still waiting...",Y=setTimeout(function(){gameStarted===!1&&(y.innerHTML="Looks like nobody's around...",setTimeout(function(){gameFinished=!0,location.reload()},getRandomInt(300,3e3)))},4e4))},15e3);window.addEventListener("focus",function(){void 0!==userRole&&(document.title="You are the "+userRole+" | Detective by @fourtonfish")},!1);var F;F=productionServer()?io(document.location.protocol+"//fourtonfish.com:3003"):io(document.location.protocol+"//"+document.location.host),R&&R.addEventListener("click",function(){"robot"===partnerRole&&n(),v.classList.add("shiftedUp"),L.classList.remove("hidden"),b.classList.remove("hidden"),b.classList.remove("shifted"),k.focus()}),B.triggerEl&&B.triggerEl.addEventListener("click",function(e){switch(e.preventDefault(),d=getEventTarget(e),d.getAttribute("data-url")){case"RELOAD":location.reload();break;default:null===B.shareUrl?(B.status.innerHTML="Loading...",m.emit("save_chat_log",I.innerHTML,userRole)):o()}}),h.length>0&&Array.prototype.forEach.call(h,function(e,t){setTimeout(function(){e.classList.remove("shifted-1"),e.classList.add("unshifted-1")},(200-10*t)*t)}),F.on("connected",function(){m=F}),F.on("chat_log_saved",function(e){console.log("chat log saved"),B.chatLogId=e,o()}),F.on("error",function(e){console.log("ERROR"),console.log(e)}),F.on("game over",function(e){"detective won"===e?c("system","YOU HAVE BEEN REVEALED"):c("system","YOU FOOLED THE DETECTIVE"),c("system","Game is over"),a()}),F.on("partner disconnected",function(e){c("system","Partner disconnected."),a(),console.log("Partner disconnected: "+e+"."),"unknown"!==partnerRole&&"detective"===userRole&&gameFinished===!1&&c("system","You were speaking with the "+partnerRole.toUpperCase()+".")}),F.on("you are",function(e){gameStarted=!0,clearTimeout(Y),userRole=e,y.classList.add("shiftedUp");var t=document.getElementsByClassName("unshifted-1");t.length>0&&Array.prototype.forEach.call(t,function(e,t){setTimeout(function(){e.classList.remove("unshifted-1"),e.classList.add("shiftedUp1")},(200-10*t)*t)}),p.length>0&&Array.prototype.forEach.call(p,function(e,t){setTimeout(function(){e.classList.remove("shifted"),e.classList.add("unshifted")},(200-10*t)*t)}),R.focus(),document.title="You are the "+userRole+" | Detective by @fourtonfish",E.innerHTML='the <span class="highlight">'+userRole+"</span>",f.innerHTML='You are the <span class="highlight">'+userRole+"</span>",w.innerHTML="detective"===userRole?'<p>You must figure out whether you are speaking to a <span class="highlight">ROBOT</span>* or an <span class="highlight">IMPOSTOR</span>, another player pretending to be a <span class="highlight">ROBOT</span>*.</p><p>Say <em>"You are an impostor"</em> or <em>"You are a robot"</em> once you are confident with your choice.</p><p class="definition">*A <a href="http://en.wikipedia.org/wiki/Chatbot" target="_blank">chatter robot</a> is a type of conversational agent, a computer program designed to simulate an intelligent conversation with one or more human users via auditory or textual methods.</p>':'<p>You must convince the <span class="highlight">DETECTIVE</span> that he or she is speaking to a <span class="highlight">ROBOT</span>*.</p><p class="definition">*A <a href="http://en.wikipedia.org/wiki/Chatbot" target="_blank">chatter robot</a> is a type of conversational agent, a computer program designed to simulate an intelligent conversation with one or more human users via auditory or textual methods.</p>'}),F.on("paired",function(o){"robot"===o.users[0]||"robot"===o.users[1]?(partnerRole="robot",T.addEventListener("click",function(o){o.preventDefault(),t(e(k.value,!0))===!1&&(n(),gameFinished===!1?(r(k.value),c("user",k.value)):alert("Let's give the robot some rest."))})):(partnerRole="detective"===userRole?"impostor":"detective",T.addEventListener("click",function(o){o.preventDefault(),t(e(k.value,!0))===!1&&(F.emit("send message",{from:userRole,message:k.value}),c("user",k.value))}))}),F.on("message received",function(e){"unknown"===partnerRole&&(partnerRole=e.from),e.from!==userRole&&c(partnerRole,e.message)})});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNjcmlwdHMuMS42Lm1pbi5qcyJdLCJuYW1lcyI6WyJyZWFkeSIsImZuIiwiZG9jdW1lbnQiLCJyZWFkeVN0YXRlIiwiYWRkRXZlbnRMaXN0ZW5lciIsInByb2R1Y3Rpb25TZXJ2ZXIiLCJ3aW5kb3ciLCJsb2NhdGlvbiIsImhyZWYiLCJpbmRleE9mIiwicmVtb3ZlQ2xhc3NlcyIsImVsIiwiY2xhc3NOYW1lIiwiZ2V0RXZlbnRUYXJnZXQiLCJlIiwiZXZlbnQiLCJ0YXJnZXQiLCJzcmNFbGVtZW50IiwiZ2V0UmFuZG9tSW50IiwibWluIiwibWF4IiwiTWF0aCIsImZsb29yIiwicmFuZG9tIiwic21vb3RoU2Nyb2xsIiwicXVlcnlTZWxlY3RvckFsbCIsInBhZ2VZT2Zmc2V0IiwiaGlzdG9yeSIsInB1c2hTdGF0ZSIsImdldFRvcCIsImVsZW1lbnQiLCJub2RlTmFtZSIsImdldEJvdW5kaW5nQ2xpZW50UmVjdCIsInRvcCIsImVhc2VJbk91dEN1YmljIiwidCIsInBvc2l0aW9uIiwic3RhcnQiLCJlbmQiLCJlbGFwc2VkIiwiZHVyYXRpb24iLCJjYWxsYmFjayIsInBhcnNlSW50IiwiY2xvY2siLCJEYXRlIiwibm93IiwicmVxdWVzdEFuaW1hdGlvbkZyYW1lIiwibW96UmVxdWVzdEFuaW1hdGlvbkZyYW1lIiwid2Via2l0UmVxdWVzdEFuaW1hdGlvbkZyYW1lIiwic2V0VGltZW91dCIsInN0ZXAiLCJzY3JvbGwiLCJsaW5rSGFuZGxlciIsImV2IiwicHJldmVudERlZmF1bHQiLCJnZXRFbGVtZW50QnlJZCIsInRoaXMiLCJoYXNoIiwic3Vic3RyaW5nIiwiYSIsImludGVybmFsIiwiaSIsImxlbmd0aCIsInhtbFRvSlNPTiIsInhtbFZhbHVlIiwieDJqcyIsIlgySlMiLCJqc29uVmFsdWUiLCJ4bWxfc3RyMmpzb24iLCJyZXNwb25zZSIsInVzZXJSb2xlIiwicGFydG5lclJvbGUiLCJnYW1lU3RhcnRlZCIsImdhbWVGaW5pc2hlZCIsIm9uYmVmb3JldW5sb2FkIiwiY2xlYXJUZXh0IiwidGV4dCIsInJlbW92ZVB1bmN0dWF0aW9uIiwidG9Mb3dlckNhc2UiLCJ0cmltIiwicmVwbGFjZSIsImNvbnRhaW5zT2ZmZW5zaXZlTGFuZ3VhZ2UiLCJqIiwib2ZmZW5zaXZlV29yZHMiLCJSZWdFeHAiLCJ0ZXN0IiwiYWRkTWVzc2FnZSIsInNoYXJlQ2hhdExvZyIsInNoYXJlQ2hhdExvZ01vZHVsZSIsInNlcnZpY2UiLCJzaGFyZVRhcmdldCIsImdldEF0dHJpYnV0ZSIsImNvbnNvbGUiLCJsb2ciLCJzaGFyZVRpdGxlIiwic2hhcmVVcmwiLCJjaGF0TG9nSWQiLCJzdGF0dXMiLCJpbm5lckhUTUwiLCJvcGVuIiwicmVzdGFydEdsb2JhbFRpbWVyIiwiY2xlYXJUaW1lb3V0IiwiZ2xvYmFsVGltZXIiLCJwb2tlVGhlUm9ib3QiLCJsZXNzQ2xldmVyIiwicm9ib3QiLCJ1c2VMZXNzQ2xldmVyIiwidGVtcCIsInNwbGl0Iiwic2hvd1NoYXJpbmdCdXR0b25zIiwic2hhcmVDaGF0TG9nV3JhcHBlciIsInN0eWxlIiwiZGlzcGxheSIsIkFycmF5IiwicHJvdG90eXBlIiwiZm9yRWFjaCIsImNhbGwiLCJnZXRFbGVtZW50c0J5Q2xhc3NOYW1lIiwiaW5kZXgiLCJjbGFzc0xpc3QiLCJyZW1vdmUiLCJhZGQiLCJjb250YWN0VGhlUm9ib3QiLCJtZXNzYWdlIiwiYWxyZWFkeUFuc3dlcmVkIiwicHVzaCIsInJlcXVlc3QiLCJYTUxIdHRwUmVxdWVzdCIsImlkIiwiY29udmVyc2F0aW9uSUQiLCJvbmxvYWQiLCJyZXNwIiwicmVzcG9uc2VUZXh0IiwiX2NvbnZlcnNhdGlvbiIsInVuZGVmaW5lZCIsImJhZFdvcmRzIiwiam9pbiIsInJvYm90UmVzcG9uZCIsImFsZXJ0Iiwib25lcnJvciIsInNlbmQiLCJhbHJlYWR5QW5zd2VyZWRSZXNwb25zZXMiLCJhbm5veWVkTWVzc2FnZSIsInNwbGljZSIsInNlbmRUZXh0IiwibmFtZSIsImZyb20iLCJwZW5kaW5nUmVzcG9uc2VzIiwibmV4dE1lc3NhZ2UiLCJzaGlmdCIsIm5leHRNZXNzYWdlTGVuZ3RoIiwibmV4dE1lc3NhZ2VEZWxheSIsInJlc3BvbnNlUGVuZGluZyIsInJldmVhbEltcG9zdG9yIiwiZGV0ZWN0aXZlR3Vlc3MiLCJnbG9iYWxTb2NrZXQiLCJlbWl0IiwibWVzc2FnZUZyb20iLCJtZXNzYWdlVGV4dCIsIm5ld01lc3NhZ2UiLCJjcmVhdGVFbGVtZW50IiwiZnVuU3R1ZmYiLCJtZXNzYWdlcyIsImFwcGVuZENoaWxkIiwibWVzc2FnZVRleHRJbnB1dCIsInZhbHVlIiwiaGFzRm9jdXMiLCJ0aXRsZSIsImJvZHkiLCJzY3JvbGxUb3AiLCJzY3JvbGxIZWlnaHQiLCJzY3JvbGxUbyIsInNoaWZ0ZWRFbHMxIiwic2hpZnRlZEVscyIsImxvYWRpbmdJbmRpY2F0b3IiLCJ5b3VBcmUiLCJpbnN0cnVjdGlvbnNXcmFwcGVyIiwiaW5zdHJ1Y3Rpb25zIiwiZGlzbWlzc0luc3RydWN0aW9uc0J1dHRvbiIsIm1vcmVJbmZvIiwicm9sZVJlbWluZGVyIiwibWVzc2FnZUZvcm0iLCJzZW5kTWVzc2FnZUJ1dHRvbiIsIm1lc3NhZ2VzV3JhcHBlciIsInRyaWdnZXJFbCIsInJvYm90SURzIiwibmFtZXMiLCJwbGFjZXNQcml2YXRlIiwiZ2xvYmFsVGltZXJXYWl0aW5nIiwicmVsb2FkIiwic29ja2V0IiwiaW8iLCJwcm90b2NvbCIsImhvc3QiLCJmb2N1cyIsIm9uIiwiZGF0YSIsInRvVXBwZXJDYXNlIiwidW5zaGlmdGVkRWxzMSIsInVzZXJzIl0sIm1hcHBpbmdzIjoiQUFBQSxRQWtFQSxTQUFTQSxPQUFNQyxHQUNlLFlBQXhCQyxTQUFTQyxXQUNYRixJQUVBQyxTQUFTRSxpQkFBaUIsbUJBQW9CSCxHQUlsRCxRQUFTSSxvQkFDUCxNQUFRQyxRQUFPQyxTQUFTQyxLQUFLQyxRQUFRLG1CQUFxQixHQUc1RCxRQUFTQyxlQUFjQyxHQUNyQkEsRUFBR0MsVUFBWSxHQUlqQixRQUFTQyxnQkFBZUMsR0FFdEIsTUFEQUEsR0FBSUEsR0FB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QVcsT0FFYnlGLEdBRUUsVUFFRkMsR0FDRSxXQUNBLG9CQUNBLHdCQUNBLFFBQ0EsTUFDQSxPQUNBLE9BQ0EsU0FDQSxRQUNBLE9BQ0EsU0FDQSxRQUNBLFFBQ0EsU0FDQSxRQUNBLFFBQ0EsVUFDQSxPQUNBLFNBQ0EsU0FDQSxVQUNBLE9BQ0EsU0FDQSxZQUNBLFFBQ0EsT0FDQSxXQUNBLFNBQ0EsUUFDQSxNQUNBLFlBQ0EsVUFDQSxVQUNBLFdBQ0EsUUFDQSxTQUNBLE1BQ0EsUUFDQSxRQUNBLFVBQ0EsUUFDQSxNQUNBLE1BQ0EsV0FDQSxRQUNBLFdBQ0EsVUFDQSxVQUNBLE9BQ0EsU0FDQSxVQUNBLFdBQ0EsT0FDQSxXQUNBLFVBQ0EsUUFDQSxTQUNBLFlBQ0EsUUFDQSxVQUNBLE9BQ0EsU0FDQSxRQUNBLFNBQ0EsT0FDQSxRQUNBLFNBQ0EsVUFDQSxVQUNBLE9BQ0EsT0FDQSxTQUNBLFFBQ0EsUUFDQSxVQUNBLFVBQ0EsT0FDQSxTQUNBLFNBQ0EsVUFDQSxXQUNBLFdBQ0EsU0FDQSxRQUNBLFFBQ0EsVUFDQSxRQUNBLFNBQ0EsUUFDQSxVQUNBLFFBQ0EsU0FDQSxTQUNBLFNBQ0EsTUFDQSxLQUNBLFVBQ0EsV0FDQSxXQUNBLFNBQ0EsV0FDQSxTQUNBLFFBQ0EsUUFDQSxNQUNBLFNBQ0EsU0FPRkMsR0FDQSwwQkFDQSxtQkFDQSxZQUNBLDRCQUNBLE1BQ0EsZUFDQSxpQkFFQXBELEdBSUUsV0FDQSxTQUNBLFFBQ0EsV0FDQSxXQUNBLFFBQ0EsT0FDQSxPQUNBLE9BQ0EsUUFDQSxPQUNBLE9BQ0EsWUFDQSxPQUNBLE1BQ0EsU0FDQSxRQUNBLE9BQ0EsT0FDQSxXQUNBLE9BQ0EsTUFDQSxPQUNBLFNBQ0EsTUFDQSxPQUNBLFFBQ0EsT0FDQSxVQUNBLFFBQ0EsUUFDQSxRQUNBLFNBQ0EsT0FDQSxhQUNBLFFBQ0EsVUFDQSxTQUNBLFVBQ0EsUUFDQSxPQUNBLFFBQ0EsT0FDQSxRQUNBLE9BQ0EsT0FDQSxPQUNBLFdBQ0EsU0FDQSxPQUNBLFVBQ0EsUUFDQSxPQUVGOUIsR0FDRXVCLEdBQUl5RCxFQUFT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QU9sQyxLQUFLLGdCQUNSVixLQUFNNUUsU0FDTnFELFFBQVN5QyxFQUFpQkMsUUFHOUIvRSxFQUFXLE9BQVE4RSxFQUFpQkMsYUFPNUN5QixFQUFPSyxHQUFHLG1CQUFvQixTQUFTQyxHQUNqQixZQUFoQjdILGNBQ0ZBLFlBQWM2SCxFQUFLbEQsTUFFakJrRCxFQUFLbEQsT0FBUzVFLFVBQ2hCZ0IsRUFBV2YsWUFBYTZILEVBQUt6RSIsImZpbGUiOiJzY3JpcHRzLjEuNi5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJcInN0cmljdFwiO1xuLypcbiAgaHR0cHM6Ly9naXRodWIuY29tL2FsaWNlbGlldXRpZXIvc21vb3RoU2Nyb2xsXG4qL1xud2luZG93LnNtb290aFNjcm9sbCA9IChmdW5jdGlvbigpe1xuaWYoZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCA9PT0gdm9pZCAwIHx8IHdpbmRvdy5wYWdlWU9mZnNldCA9PT0gdm9pZCAwIHx8IGhpc3RvcnkucHVzaFN0YXRlID09PSB2b2lkIDApIHsgcmV0dXJuOyB9XG52YXIgZ2V0VG9wID0gZnVuY3Rpb24oZWxlbWVudCkge1xuICAgIGlmKGVsZW1lbnQubm9kZU5hbWUgPT09ICdIVE1MJyl7XG4gICAgICByZXR1cm4gLXdpbmRvdy5wYWdlWU9mZnNldDtcbiAgICB9IFxuICAgIHJldHVybiBlbGVtZW50LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLnRvcCArIHdpbmRvdy5wYWdlWU9mZnNldDtcbn07XG52YXIgZWFzZUluT3V0Q3ViaWMgPSBmdW5jdGlvbiAodCkgeyByZXR1cm4gdDwwLjUgPyA0KnQqdCp0IDogKHQtMSkqKDIqdC0yKSooMip0LTIpKzE7IH07XG52YXIgcG9zaXRpb24gPSBmdW5jdGlvbihzdGFydCwgZW5kLCBlbGFwc2VkLCBkdXJhdGlvbikge1xuICAgIGlmIChlbGFwc2VkID4gZHVyYXRpb24pe1xuICAgICAgcmV0dXJuIGVuZDtcbiAgICB9IFxuICAgIHJldHVybiBzdGFydCArIChlbmQgLSBzdGFydCkgKiBlYXNlSW5PdXRDdWJpYyhlbGFwc2VkIC8gZHVyYXRpb24pO1xufTtcbnZhciBzbW9vdGhTY3JvbGwgPSBmdW5jdGlvbihlbCwgZHVyYXRpb24sIGNhbGxiYWNrKXtcbiAgICBkdXJhdGlvbiA9IGR1cmF0aW9uIHx8IDUwMDtcbiAgICB2YXIgc3RhcnQgPSB3aW5kb3cucGFnZVlPZmZzZXQsXG4gICAgICAgIGVuZDtcbiAgICBpZiAodHlwZW9mIGVsID09PSAnbnVtYmVyJykge1xuICAgICAgZW5kID0gcGFyc2VJbnQoZWwpO1xuICAgIH0gZWxzZSB7XG4gICAgICBlbmQgPSBnZXRUb3AoZWwpO1xuICAgIH1cbiAgICB2YXIgY2xvY2sgPSBEYXRlLm5vdygpO1xuICAgIHZhciByZXF1ZXN0QW5pbWF0aW9uRnJhbWUgPSB3aW5kb3cucmVxdWVzdEFuaW1hdGlvbkZyYW1lIHx8XG4gICAgICAgIHdpbmRvdy5tb3pSZXF1ZXN0QW5pbWF0aW9uRnJhbWUgfHwgd2luZG93LndlYmtpdFJlcXVlc3RBbmltYXRpb25GcmFtZSB8fFxuICAgICAgICBmdW5jdGlvbihmbil7d2luZG93LnNldFRpbWVvdXQoZm4sIDE1KTt9O1xuICAgIHZhciBzdGVwID0gZnVuY3Rpb24oKXtcbiAgICAgICAgdmFyIGVsYXBzZWQgPSBEYXRlLm5vdygpIC0gY2xvY2s7XG4gICAgICAgIHdpbmRvdy5zY3JvbGwoMCwgcG9zaXRpb24oc3RhcnQsIGVuZCwgZWxhcHNlZCwgZHVyYXRpb24pKTtcbiAgICAgICAgaWYgKGVsYXBzZWQgPiBkdXJhdGlvbikge1xuICAgICAgICAgICAgaWYgKHR5cGVvZiBjYWxsYmFjayA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgICAgIGNhbGxiYWNrKGVsKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZShzdGVwKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgc3RlcCgpO1xufTtcbnZhciBsaW5rSGFuZGxlciA9IGZ1bmN0aW9uKGV2KSB7XG4gICAgZXYucHJldmVudERlZmF1bHQoKTtcbiAgICBzbW9vdGhTY3JvbGwoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQodGhpcy5oYXNoLnN1YnN0cmluZygxKSksIDUwMCwgZnVuY3Rpb24oZWwpIHtcbiAgICB9KTtcbn07XG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwiRE9NQ29udGVudExvYWRlZFwiLCBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGludGVybmFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnYVtocmVmXj1cIiNcIl0nKSwgYTtcbiAgICBmb3IodmFyIGk9aW50ZXJuYWwubGVuZ3RoOyBhPWludGVybmFsWy0taV07KXtcbiAgICAgICAgYS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgbGlua0hhbmRsZXIsIGZhbHNlKTtcbiAgICB9XG59KTtcbnJldHVybiBzbW9vdGhTY3JvbGw7XG59KSgpO1xuXG52YXIgeG1sVG9KU09OID0gZnVuY3Rpb24oeG1sVmFsdWUpIHtcbiAgdmFyIHgyanMgPSBuZXcgWDJKUygpLFxuICAgICAganNvblZhbHVlID0geDJqcy54bWxfc3RyMmpzb24oeG1sVmFsdWUpO1xuICBqc29uVmFsdWUgPSBqc29uVmFsdWUucmVzcG9uc2U7XG4gIHJldHVybiBqc29uVmFsdWU7XG59O1xuXG5mdW5jdGlvbiByZWFkeShmbikge1xuICBpZiAoZG9jdW1lbnQucmVhZHlTdGF0ZSAhPT0gJ2xvYWRpbmcnKXtcbiAgICBmbigpO1xuICB9IGVsc2Uge1xuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCBmbik7XG4gIH1cbn1cblxuZnVuY3Rpb24gcHJvZHVjdGlvblNlcnZlcigpe1xuICByZXR1cm4gKHdpbmRvdy5sb2NhdGlvbi5ocmVmLmluZGV4T2YoJ2ZvdXJ0b25maXNoLmNvbScpID4gLTEpO1xufVxuXG5mdW5jdGlvbiByZW1vdmVDbGFzc2VzKGVsKXtcbiAgZWwuY2xhc3NOYW1lID0gJyc7XG59XG5cbi8vaHR0cDovL3N0YWNrb3ZlcmZsb3cuY29tL3F1ZXN0aW9ucy81MTE2OTI5L2dldC1jbGlja2VkLWxpLWZyb20tdWwtb25jbGlja1xuZnVuY3Rpb24gZ2V0RXZlbnRUYXJnZXQoZSkge1xuICBlID0gZSB8fCB3aW5kb3cuZXZlbnQ7XG4gIHJldHVybiBlLnRhcmdldCB8fCBlLnNyY0VsZW1lbnQ7IFxufVxuXG4vL2h0dHA6Ly9zdGFja292ZXJmbG93LmNvbS9xdWVzdGlvbnMvMTUyNzgwMy9nZW5lcmF0aW5nLXJhbmRvbS1udW1iZXJzLWluLWphdmFzY3JpcHQtaW4tYS1zcGVjaWZpYy1yYW5nZVxuZnVuY3Rpb24gZ2V0UmFuZG9tSW50KG1pbiwgbWF4KSB7XG4gIHJldHVybiBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAobWF4IC0gbWluICsgMSkpICsgbWluO1xufVxuXG52YXIgdXNlclJvbGUsIC8vIHJvYm90IG9yIGltcG9zdG9yXG4gICAgcGFydG5lclJvbGUgPSAndW5rbm93bicsXG4gICAgZ2FtZVN0YXJ0ZWQgPSBmYWxzZSxcbiAgICBnYW1lRmluaXNoZWQgPSBmYWxzZTtcblxuXG53aW5kb3cub25iZWZvcmV1bmxvYWQgPSBmdW5jdGlvbihlKSB7XG4gIGlmIChnYW1lRmluaXNoZWQgPT09IGZhbHNlKXtcbiAgICByZXR1cm4gJ0FyZSB5b3Ugc3VyZT8nO1xuICB9XG59O1xuXG5cbnJlYWR5KGZ1bmN0aW9uKCl7XG4gIHZhciBzaGlmdGVkRWxzMSA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ3NoaWZ0ZWQtMScpLFxuICAgICAgc2hpZnRlZEVscyA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ3NoaWZ0ZWQnKSxcbiAgICAgIGxvYWRpbmdJbmRpY2F0b3IgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbG9hZGluZycpLFxuICAgICAgeW91QXJlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3lvdS1hcmUnKSxcbiAgICAgIGluc3RydWN0aW9uc1dyYXBwZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaW5zdHJ1Y3Rpb25zLXdyYXBwZXInKSxcbiAgICAgIGluc3RydWN0aW9ucyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdpbnN0cnVjdGlvbnMnKSxcbiAgICAgIGRpc21pc3NJbnN0cnVjdGlvbnNCdXR0b24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZGlzbWlzcy1pbnN0cnVjdGlvbnMnKSxcbiAgICAgIG1vcmVJbmZvID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21vcmUtaW5mbycpLFxuICAgICAgcm9sZVJlbWluZGVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3JvbGUtcmVtaW5kZXInKSxcbiAgICAgIG1lc3NhZ2VGb3JtID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21lc3NhZ2UtZm9ybScpLFxuICAgICAgc2VuZE1lc3NhZ2VCdXR0b24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2VuZC1tZXNzYWdlJyksXG4gICAgICBtZXNzYWdlVGV4dElucHV0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21lc3NhZ2UtdGV4dCcpLFxuICAgICAgbWVzc2FnZXNXcmFwcGVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21lc3NhZ2VzLXdyYXBwZXInKSxcbiAgICAgIG1lc3NhZ2VzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21lc3NhZ2VzJyksXG4gICAgICBzaGFyZUNoYXRMb2dXcmFwcGVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NoYXJlLWNoYXQtbG9nLXdyYXBwZXInKSxcbiAgICAgIHdoYXRJc1RoaXNMaW5rID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3doYXQtaXMtdGhpcycpLFxuLy8gICAgICByZXF1ZXN0Tm90aWZpY2F0aW9uUGVybWlzc2lvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXF1ZXN0LW5vdGlmaWNhdGlvbi1wZXJtaXNzaW9uJyksXG4gICAgICBzaGFyZUNoYXRMb2dNb2R1bGUgPSB7XG4gICAgICAgIHRyaWdnZXJFbDogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NoYXJlLWJ1dHRvbnMtZ2FtZScpLFxuICAgICAgICBzZXJ2aWNlOiBudWxsLFxuICAgICAgICBzdGF0dXM6IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjaGF0LWxvZy11cmwtc3RhdHVzJyksXG4gICAgICAgIHNoYXJlVXJsOiBudWxsLFxuICAgICAgICBjaGF0TG9nSWQ6IG51bGxcbiAgICAgIH0sXG4gICAgICByb2JvdElEcyA9IFtcbiAgICAgICAgLy8gJzM3JyxcbiAgICAgICAgJzkwOTQwOSdcbiAgICAgIF0sXG4gICAgICBuYW1lcyA9IFtcbiAgICAgICAgJ3lvdXIgbW9tJyxcbiAgICAgICAgJ25vdCB5b3VyIGJ1c2luZXNzJyxcbiAgICAgICAgJ25vbmUgb2YgeW91ciBidXNpbmVzcycsXG4gICAgICAgICdTdGV2ZScsXG4gICAgICAgICdCb2InLFxuICAgICAgICAnTHVjeScsXG4gICAgICAgICdSaXRhJyxcbiAgICAgICAgJ0NsZXR1cycsIMKgXG4gICAgICAgICdSdWZ1cycsIMKgXG4gICAgICAgICdHYWxlJywgwqBcbiAgICAgICAgJ1NpZG5leScsIMKgXG4gICAgICAgICdFbW1pZScsIMKgXG4gICAgICAgICdFdGh5bCcsIMKgXG4gICAgICAgICdCYWJhcmEnLCDCoFxuICAgICAgICAnSm9kaWUnLCDCoFxuICAgICAgICAnS2Fyb24nLCDCoFxuICAgICAgICAnUmFzaGlkYScsIMKgXG4gICAgICAgICdPbGVuJywgwqBcbiAgICAgICAgJ0ZlbGlzYScsIMKgXG4gICAgICAgICdOZW5pdGEnLCDCoFxuICAgICAgICAnQ2FtaWxsZScsIMKgXG4gICAgICAgICdTaGF5JywgwqBcbiAgICAgICAgJ1Bob2ViZScsIMKgXG4gICAgICAgICdBbmdlbGlxdWUnLCDCoFxuICAgICAgICAnTW9udGUnLCDCoFxuICAgICAgICAnRXhpZScsIMKgXG4gICAgICAgICdMdWNyZWNpYScsIMKgXG4gICAgICAgICdNZWxvZGknLCDCoFxuICAgICAgICAnTWFyZ2UnLCDCoFxuICAgICAgICAnWm9lJywgwqBcbiAgICAgICAgJ0Nhc3NhbmRyYScsIMKgXG4gICAgICAgICdSb3NhdXJhJywgwqBcbiAgICAgICAgJ0JyZW5kb24nLCDCoFxuICAgICAgICAnTWNraW5sZXknLCDCoFxuICAgICAgICAnTHVjaWUnLCDCoFxuICAgICAgICAnU2hhbmRpJywgwqBcbiAgICAgICAgJ01hbycsIMKgXG4gICAgICAgICdWaWxtYScsIMKgXG4gICAgICAgICdTaGFyYScsIMKgXG4gICAgICAgICdHaXNlbGxlJywgwqBcbiAgICAgICAgJ1JveWFsJywgwqBcbiAgICAgICAgJ0RpYScsIMKgXG4gICAgICAgICdJdnknLCDCoFxuICAgICAgICAnU2hlcmlkYW4nLCDCoFxuICAgICAgICAnS2FuZGknLCDCoFxuICAgICAgICAnSnVsaWV0dGUnLCDCoFxuICAgICAgICAnQ2FtaWxsYScsIMKgXG4gICAgICAgICdTdXNhbm5hJywgwqBcbiAgICAgICAgJ0dhcnknLCDCoFxuICAgICAgICAnR2VydGhhJywgwqBcbiAgICAgICAgJ0JyaXRhbnknLCDCoFxuICAgICAgICAnTWFydmVsbGEnLCDCoFxuICAgICAgICAnU2luYScsIMKgXG4gICAgICAgICdMYWtlZXNoYScsIMKgXG4gICAgICAgICdTaGVyaWxsJywgwqBcbiAgICAgICAgJ1RvbmV5JywgwqBcbiAgICAgICAgJ1NoZXJyaScsXG4gICAgICAgICdBbGJlcnRpbmEnLCDCoFxuICAgICAgICAnVGFyZW4nLCDCoFxuICAgICAgICAnSGlsZHJlZCcsIMKgXG4gICAgICAgICdFcm1hJywgwqBcbiAgICAgICAgJ0xlbmFyZCcsIMKgXG4gICAgICAgICdUeXNvbicsIMKgXG4gICAgICAgICdNYXJrdXMnLCDCoFxuICAgICAgICAnSW5leicsIMKgXG4gICAgICAgICdMZXR0eScsIMKgXG4gICAgICAgICdEZWVkcmEnLCDCoFxuICAgICAgICAnVGFtbWVyYScsIMKgXG4gICAgICAgICdTdGFubGV5JywgwqBcbiAgICAgICAgJ0xvcmEnLCDCoFxuICAgICAgICAnTGVvbicsIMKgXG4gICAgICAgICdCZWxraXMnLCDCoFxuICAgICAgICAnSmFuYWUnLCDCoFxuICAgICAgICAnTGVubmEnLCDCoFxuICAgICAgICAnQnJvbnd5bicsIMKgXG4gICAgICAgICdLaW1iZXJ5JywgwqBcbiAgICAgICAgJ0RlYmknLCDCoFxuICAgICAgICAnQmVybmllJywgwqBcbiAgICAgICAgJ0FsbGVlbicsIMKgXG4gICAgICAgICdEZWxvaXNlJywgwqBcbiAgICAgICAgJ0NoaXF1aXRhJywgwqBcbiAgICAgICAgJ1NoYW5lbGxlJywgwqBcbiAgICAgICAgJ1d5bm9uYScsIMKgXG4gICAgICAgICdLaXNoYScsIMKgXG4gICAgICAgICdNaW5uYScsIMKgXG4gICAgICAgICdMYXJvbmRhJywgwqBcbiAgICAgICAgJ0NoYXlhJywgwqBcbiAgICAgICAgJ0FuYWJlbCcsIMKgXG4gICAgICAgICdMZWlsYScsIMKgXG4gICAgICAgICdBcmxldGhhJywgwqBcbiAgICAgICAgJ0xveWNlJywgwqBcbiAgICAgICAgJ0NyeXN0YScsIMKgXG4gICAgICAgICdNYWVnYW4nLCDCoFxuICAgICAgICAnVmFsZXJ5JywgwqBcbiAgICAgICAgJ0hlZScsIMKgXG4gICAgICAgICdFZCcsIMKgXG4gICAgICAgICdNaXRzdWtvJywgwqBcbiAgICAgICAgJ1ZpbmNlbnpvJywgwqBcbiAgICAgICAgJ01lcmNlZGV6JywgwqBcbiAgICAgICAgJ0phbmVlbicsIMKgXG4gICAgICAgICdGcmVkcmljaycsIMKgXG4gICAgICAgICdTaGFyZGEnLCDCoFxuICAgICAgICAnRHlsYW4nLCDCoFxuICAgICAgICAnQ2Fzc2knLCDCoFxuICAgICAgICAnTWFlJywgwqBcbiAgICAgICAgJ0JvYmJ5ZScsIMKgXG4gICAgICAgICdMYW5ueScgICBcbiAgICAgIF0sXG4gICAgICBwbGFjZXMgPSBbXG4gICAgICAnUm9ib3QgZmFjdG9yeScsXG4gICAgICAnTmV3IFlvcmsnLFxuICAgICAgJ0Jyb29rbHluJ1xuICAgICAgXSxcbiAgICAgIHBsYWNlc1ByaXZhdGUgPSBbXG4gICAgICAnVWgsIHdoZXJlIGFyZSB5b3UgZnJvbT8nLFxuICAgICAgJ1RoYXRcXCdzIHBydml2YXRlLicsXG4gICAgICAnWW91ciBtb20hJyxcbiAgICAgICdJIGxpdmUgcmlnaHQgbmV4dCB0byB5b3UhJyxcbiAgICAgICcuLi4nLFxuICAgICAgJ0lcXCdtIGhvbWVsZXNzJyxcbiAgICAgICdJXFwnbSBob21lbGVzcz8nXG4gICAgICBdLFxuICAgICAgYmFkV29yZHMgPSBbXG4vKlxuICAgICAgSW1wb3J0ZWQgZnJvbSBodHRwczovL2dpdGh1Yi5jb20vZGFyaXVzay93b3JkZmlsdGVyLlxuKi8gICAgICBcbiAgICAgICAgXCJiZWV5b3RjaFwiLFxuICAgICAgICBcImJpYXRjaFwiLFxuICAgICAgICBcImJpdGNoXCIsXG4gICAgICAgIFwiY2hpbmFtYW5cIixcbiAgICAgICAgXCJjaGluYW1lblwiLFxuICAgICAgICBcImNoaW5rXCIsXG4gICAgICAgIFwiY3JpcFwiLFxuICAgICAgICBcImN1bnRcIixcbiAgICAgICAgXCJkYWdvXCIsXG4gICAgICAgIFwiZGF5Z29cIixcbiAgICAgICAgXCJkZWdvXCIsXG4gICAgICAgIFwiZGlja1wiLFxuICAgICAgICBcImRvdWNoZWJhZ1wiLFxuICAgICAgICBcImR5a2VcIixcbiAgICAgICAgXCJmYWdcIixcbiAgICAgICAgXCJmYXRhc3NcIixcbiAgICAgICAgXCJmYXRzb1wiLFxuICAgICAgICBcImdhc2hcIixcbiAgICAgICAgXCJnaW1wXCIsXG4gICAgICAgIFwiZ29sbGl3b2dcIixcbiAgICAgICAgXCJnb29rXCIsXG4gICAgICAgIFwiZ3lwXCIsXG4gICAgICAgIFwiaG9tb1wiLFxuICAgICAgICBcImhvb2tlclwiLFxuICAgICAgICBcImphcFwiLFxuICAgICAgICBcImtpa2VcIixcbiAgICAgICAgXCJrcmF1dFwiLFxuICAgICAgICBcImxhbWVcIixcbiAgICAgICAgXCJsYXJkYXNzXCIsXG4gICAgICAgIFwibGVzYm9cIixcbiAgICAgICAgXCJuZWdyb1wiLFxuICAgICAgICBcIm5pZ2dhXCIsXG4gICAgICAgIFwibmlnZ2VyXCIsXG4gICAgICAgIFwicGFraVwiLFxuICAgICAgICBcInBpY2thbmlubnlcIixcbiAgICAgICAgXCJwdXNzeVwiLFxuICAgICAgICBcInJhZ2hlYWRcIixcbiAgICAgICAgXCJyZXRhcmRcIixcbiAgICAgICAgXCJzaGVtYWxlXCIsXG4gICAgICAgIFwic2thbmtcIixcbiAgICAgICAgXCJzbHV0XCIsXG4gICAgICAgIFwic3BhZGVcIixcbiAgICAgICAgXCJzcGljXCIsXG4gICAgICAgIFwic3Bvb2tcIixcbiAgICAgICAgXCJ0YXJkXCIsXG4gICAgICAgIFwidGl0c1wiLFxuICAgICAgICBcInRpdHRcIixcbiAgICAgICAgXCJ0cmFubmllc1wiLFxuICAgICAgICBcInRyYW5ueVwiLFxuICAgICAgICBcInR3YXRcIixcbiAgICAgICAgXCJ3ZXRiYWNrXCIsXG4gICAgICAgIFwid2hvcmVcIixcbiAgICAgICAgXCJ3b3BcIlxuICAgICAgXSxcbiAgICAgIHJvYm90ID0ge1xuICAgICAgICBpZDogcm9ib3RJRHNbZ2V0UmFuZG9tSW50KDAsIHJvYm90SURzLmxlbmd0aCAtIDEpXSxcbiAgICAgICAgbmFtZTogbmFtZXNbZ2V0UmFuZG9tSW50KDAsIG5hbWVzLmxlbmd0aCAtIDEpXSxcbiAgICAgICAgZnJvbTogcGxhY2VzUHJpdmF0ZVtnZXRSYW5kb21JbnQoMCwgcGxhY2VzUHJpdmF0ZS5sZW5ndGggLSAxKV0sXG4gICAgICAgIGNvbnZlcnNhdGlvbklEOiBudWxsLFxuICAgICAgICB1c2VMZXNzQ2xldmVyOiBNYXRoLnJhbmRvbSgpIDwgMC41ID8gdHJ1ZSA6IGZhbHNlLFxuICAgICAgICByZXNwb25zZVBlbmRpbmc6IGZhbHNlLFxuICAgICAgICBwZW5kaW5nUmVzcG9uc2VzOiBbXSxcbiAgICAgICAgYWxyZWFkeUFuc3dlcmVkOiBbXSxcbiAgICAgICAgYWxyZWFkeUFuc3dlcmVkUmVzcG9uc2VzOiBbXG4gICAgICAgICAgJ1lvdSBhbHJlYWR5IGFza2VkIHRoYXQgcXVlc3Rpb24uJyxcbiAgICAgICAgICAnWW91IGFscmVhZHkgYXNrZWQgbWUgdGhhdC4nLFxuICAgICAgICAgICdJIHRoaW5rIEkgYWxyZWFkeSB0b2xkIHlvdS4nLFxuICAgICAgICAgICdJIGFscmVhZHkgdG9sZCB5b3UuJyxcbiAgICAgICAgICAnSSBhbHJlYWR5IGFuc3dlcmVkIHRoYXQuJyxcbiAgICAgICAgICAnRGlkIHlvdSByZWFkIG15IGFuc3dlcj8nLFxuICAgICAgICAgICdZb3UgYWxyZWFkeSBzYWlkIHRoYXQuJyxcbiAgICAgICAgICAnLi4uJyxcbiAgICAgICAgICAnSSB0b2xkIHlvdScsXG4gICAgICAgICAgJ0kgbGl0ZXJhbGx5IGp1c3QgdG9sZCB5b3UuJyxcbiAgICAgICAgICAnSSBqdXN0IHRvbGQgeW91LidcbiAgICAgICAgXVxuICAgICAgfSxcbiAgICAgIG9mZmVuc2l2ZVdvcmRzID0gW1xuICAgICAgICAnbihpfDEpK2d7Mix9KChlfDMpK3IrfGEpKycsXG4gICAgICAgICdmK2ErZysnLFxuICAgICAgICAnZisoYXxAKStnezIsfShvfDApK3QrJ1xuICAgICAgXSxcbiAgICAgIHNoYXJlVGFyZ2V0LFxuICAgICAgZ2xvYmFsU29ja2V0LFxuICAgICAgZ2xvYmFsVGltZXIsXG4gICAgICBnbG9iYWxUaW1lcldhaXRpbmcgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7XG4gICAgICAgIGlmIChnYW1lU3RhcnRlZCA9PT0gZmFsc2Upe1xuICAgICAgICAgIGxvYWRpbmdJbmRpY2F0b3IuaW5uZXJIVE1MID0gJ1N0aWxsIHdhaXRpbmcuLi4nO1xuICAgICAgICAgIGdsb2JhbFRpbWVyV2FpdGluZyA9IHNldFRpbWVvdXQoZnVuY3Rpb24oKXtcbiAgICAgICAgICAgIGlmIChnYW1lU3RhcnRlZCA9PT0gZmFsc2Upe1xuICAgICAgICAgICAgICBsb2FkaW5nSW5kaWNhdG9yLmlubmVySFRNTCA9ICdMb29rcyBsaWtlIG5vYm9keVxcJ3MgYXJvdW5kLi4uJztcbiAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgIGdhbWVGaW5pc2hlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgbG9jYXRpb24ucmVsb2FkKCk7XG4gICAgICAgICAgICAgIH0sIGdldFJhbmRvbUludCgzMDAsIDMwMDApKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9LCA0MDAwMCk7XG4gICAgICAgIH1cbiAgICAgIH0sIDE1MDAwKTtcblxuLy8gIHZhciBOb3RpZmljYXRpb24gPSB3aW5kb3cuTm90aWZpY2F0aW9uIHx8IHdpbmRvdy5tb3pOb3RpZmljYXRpb24gfHwgd2luZG93LndlYmtpdE5vdGlmaWNhdGlvbjtcblxuICBmdW5jdGlvbiBjbGVhclRleHQodGV4dCwgcmVtb3ZlUHVuY3R1YXRpb24pe1xuICAgIHRleHQgPSB0ZXh0LnRvTG93ZXJDYXNlKCkudHJpbSgpLnJlcGxhY2UoLyAvZywnJyk7XG4gICAgaWYgKHJlbW92ZVB1bmN0dWF0aW9uID09PSB0cnVlKXtcbiAgICAgIHRleHQgPSB0ZXh0LnJlcGxhY2UoL1suLD8hXFxzLF0vZywgJycpO1xuICAgIH1cbiAgICByZXR1cm4gdGV4dDtcbiAgfVxuXG5cbmZ1bmN0aW9uIGNvbnRhaW5zT2ZmZW5zaXZlTGFuZ3VhZ2UodGV4dCl7XG4gIGZvciAodmFyIGk9MCwgaj1vZmZlbnNpdmVXb3Jkcy5sZW5ndGg7IGk8ajsgaSsrKXtcbiAgICBpZiAobmV3IFJlZ0V4cChvZmZlbnNpdmVXb3Jkc1tpXSwgJ2dpJykudGVzdCh0ZXh0LnJlcGxhY2UoL1xcVy9nLCAnJykpID09PSB0cnVlKXtcbiAgICAgIGFkZE1lc3NhZ2UoJ3N5c3RlbScsICdFUlJPUicpOyAgICAgIFxuICAgICAgYWRkTWVzc2FnZSgnc3lzdGVtJywgJ1VuYWJsZSB0byBzZW5kIG1lc3NhZ2UnKTsgICAgICBcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgfVxuICByZXR1cm4gZmFsc2U7XG59XG5cbiAgZnVuY3Rpb24gc2hhcmVDaGF0TG9nKCl7XG4gICAgc2hhcmVDaGF0TG9nTW9kdWxlLnNlcnZpY2UgPSBzaGFyZVRhcmdldC5nZXRBdHRyaWJ1dGUoJ2RhdGEtc2VydmljZScpO1xuICAgIGNvbnNvbGUubG9nKHNoYXJlQ2hhdExvZ01vZHVsZS5zZXJ2aWNlKTtcblxuICAgIHZhciBzaGFyZVRpdGxlID0gJ1BsYXkgRGV0ZWN0aXZlLCBhIGdhbWUgYnkgQGZvdXJ0b25maXNoJztcbiAgICBpZiAoc2hhcmVDaGF0TG9nTW9kdWxlLnNlcnZpY2UgIT09IG51bGwgJiYgc2hhcmVDaGF0TG9nTW9kdWxlLnNlcnZpY2UgPT09ICdyZWRkaXQnKXtcbiAgICAgIHNoYXJlVGl0bGUgPSAnW2xvZ10gVElUTEUnO1xuICAgIH1cblxuICAgIHNoYXJlQ2hhdExvZ01vZHVsZS5zaGFyZVVybCA9IHNoYXJlVGFyZ2V0LmdldEF0dHJpYnV0ZSgnZGF0YS11cmwnKVxuICAgICAgLnJlcGxhY2UoL0RFU0NSSVBUSU9OLywgJ0RldGVjdGl2ZTogQSBcInJldmVyc2UgVHVyaW5nIHRlc3RcIiBjaGF0IGdhbWUuJylcbiAgICAgIC5yZXBsYWNlKC9DSEFUTE9HVVJML2dpLCAnaHR0cDovL2ZvdXJ0b25maXNoLmNvbS9kZXRlY3RpdmUvbG9nP2lkPScgKyBzaGFyZUNoYXRMb2dNb2R1bGUuY2hhdExvZ0lkKVxuICAgICAgLnJlcGxhY2UoL1NIT1JUVElUTEUvLCBzaGFyZVRpdGxlKTtcblxuXG4gICAgc2hhcmVDaGF0TG9nTW9kdWxlLnN0YXR1cy5pbm5lckhUTUwgPSAnJztcbiAgICB3aW5kb3cub3BlbihzaGFyZUNoYXRMb2dNb2R1bGUuc2hhcmVVcmwpO1xuICB9XG5cbiAgZnVuY3Rpb24gcmVzdGFydEdsb2JhbFRpbWVyKCl7XG4gICAgY2xlYXJUaW1lb3V0KGdsb2JhbFRpbWVyKTtcbiAgICBnbG9iYWxUaW1lciA9IHNldFRpbWVvdXQoZnVuY3Rpb24oKXtcbiAgICAgIHBva2VUaGVSb2JvdCgpO1xuICAgIH0sIGdldFJhbmRvbUludCgzMDAwMCwgNjAwMDApKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGxlc3NDbGV2ZXIodGV4dCl7XG4gICAgaWYgKHJvYm90LnVzZUxlc3NDbGV2ZXIgPT09IHRydWUgJiYgdGV4dCAhPT0gJy4uLicpe1xuICAgICAgdGV4dCA9IHRleHQudG9Mb3dlckNhc2UoKS5yZXBsYWNlKC9eKGkgKXwgaSAvaWcsXCIgSSBcIikudHJpbSgpO1xuICAgICAgdmFyIHRlbXAgPSB0ZXh0LnJlcGxhY2UoLyhbLj8hXSlcXHMqKD89W0EtWl0pLywgXCIkMXxcIikuc3BsaXQoXCJ8XCIpO1xuXG4gICAgICBpZiAodGVtcC5sZW5ndGggPT09IDEpe1xuICAgICAgICB0ZXh0ID0gdGV4dC5yZXBsYWNlKC9cXC4kLywgXCJcIik7XG4gICAgICB9XG5cbiAgICAgIGlmIChnZXRSYW5kb21JbnQoMSwgMTApID09PSA1KXtcbiAgICAgICAgdGV4dCA9IHRleHQucmVwbGFjZSgvKCcpL2dpLCBcIlwiKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBzd2l0Y2ggKGdldFJhbmRvbUludCgxLCAxMDAwMCkpe1xuICAgICAgY2FzZSAnMSc6XG4gICAgICAgIHRleHQgPSB0ZXh0LnJlcGxhY2UoJ2xsJywgJ2wnKTtcbiAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAnMic6XG4gICAgICAgIHRleHQgPSB0ZXh0LnJlcGxhY2UoJ3NzJywgJ3MnKTtcbiAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAnMyc6XG4gICAgICAgIHRleHQgPSB0ZXh0LnJlcGxhY2UoJ2wnLCAnaycpO1xuICAgICAgYnJlYWs7XG4gICAgICBjYXNlICc0JzpcbiAgICAgICAgdGV4dCA9IHRleHQucmVwbGFjZSgnbycsICdwJyk7XG4gICAgICBicmVhaztcbiAgICAgIGNhc2UgJzQnOlxuICAgICAgICB0ZXh0ID0gdGV4dC5yZXBsYWNlKCd3JywgJ3MnKTtcbiAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAnNSc6XG4gICAgICAgIHRleHQgPSB0ZXh0LnJlcGxhY2UoJ3MnLCAnZCcpO1xuICAgICAgYnJlYWs7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRleHQ7XG4gIH1cblxuICBmdW5jdGlvbiBjaGVja1JvbGUobWVzc2FnZSl7XG5cbiAgfVxuXG5cbiAgZnVuY3Rpb24gc2hvd1NoYXJpbmdCdXR0b25zKCl7XG4gICAgc2hhcmVDaGF0TG9nV3JhcHBlci5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJztcbiAgICAvL1RPRE86IFRoaXMgc2hvdWxkIGJlIGEgZnVuY3Rpb24sIGVnIHJlbW92ZUNsYXNzU3RhZ2dlcmVkKGNsYXNzKVxuICAgIEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwoZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgnc2hhcmUtbGluay1zaGlmdGVkJyksIGZ1bmN0aW9uKGVsLCBpbmRleCkge1xuICAgICAgc2V0VGltZW91dChcbiAgICAgICAgZnVuY3Rpb24oKXtcbiAgICAgICAgICBlbC5jbGFzc0xpc3QucmVtb3ZlKCdzaGFyZS1saW5rLXNoaWZ0ZWQnKTtcbiAgICAgICAgICBlbC5jbGFzc0xpc3QuYWRkKCdzaGFyZS1saW5rLXVuc2hpZnRlZCcpO1xuICAgICAgICB9LFxuICAgICAgICAoKDEwKmluZGV4KSkqaW5kZXgpO1xuICAgIH0pOyAgICBcbiAgfVxuXG4gIGZ1bmN0aW9uIGNvbnRhY3RUaGVSb2JvdChtZXNzYWdlKXtcbiAgICBpZiAocm9ib3QuYWxyZWFkeUFuc3dlcmVkLmluZGV4T2YoY2xlYXJUZXh0KG1lc3NhZ2UsIHRydWUpKSA9PT0gLTEpe1xuICAgICAgaWYgKG1lc3NhZ2UgIT09ICcuLi4nKXtcbiAgICAgICAgcm9ib3QuYWxyZWFkeUFuc3dlcmVkLnB1c2goY2xlYXJUZXh0KG1lc3NhZ2UsIHRydWUpKTtcbiAgICAgIH1cbiAgICAgIHZhciByZXF1ZXN0ID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7XG4gIC8vIEJhY2tlbmQgZG9lc24ndCBzdXBwb3J0IGRhdGEgaW4gSlNPTiBmb3JtYXQsIGtlZXBpbmcgdGhpcyBoZXJlIGZvciBmdXR1cmUuXG4gIC8vICAgIHJlcXVlc3Qub3BlbignR0VUJywgJy8vd3d3LmJvdGxpYnJlLmNvbS9yZXN0L2JvdGxpYnJlL2Zvcm0tY2hhdCcgLCB0cnVlKTtcbiAgICAgIHJlcXVlc3Qub3BlbignR0VUJywgJy8vd3d3LmJvdGxpYnJlLmNvbS9yZXN0L2JvdGxpYnJlL2Zvcm0tY2hhdD9pbnN0YW5jZT0nICsgcm9ib3QuaWQgKyAnJmFwcGxpY2F0aW9uPTE1NTUyNTAzMDQxNzMwMDU5NSZtZXNzYWdlPScgKyBtZXNzYWdlICsgKHJvYm90LmNvbnZlcnNhdGlvbklEICE9PSBudWxsID8gJyZjb252ZXJzYXRpb249JyArIHJvYm90LmNvbnZlcnNhdGlvbklEIDogJycpLCB0cnVlKTtcbiAgICAgIHJlcXVlc3Qub25sb2FkID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIGlmIChyZXF1ZXN0LnN0YXR1cyA+PSAyMDAgJiYgcmVxdWVzdC5zdGF0dXMgPCA0MDApIHtcbiAgICAvLyAgICBKU09OIGlzIG5vdCB5ZXQgc3VwcG9ydGVkLCBvbmx5IFhNTC5cbiAgICAvLyAgICB2YXIgZGF0YSA9IEpTT04ucGFyc2UocmVxdWVzdC5yZXNwb25zZVRleHQpO1xuICAgICAgICAgIHZhciByZXNwID0geG1sVG9KU09OKHJlcXVlc3QucmVzcG9uc2VUZXh0KTtcbiAgICAgICAgICBpZiAocm9ib3QuY29udmVyc2F0aW9uSUQgPT09IG51bGwpe1xuICAgICAgICAgICAgcm9ib3QuY29udmVyc2F0aW9uSUQgPSByZXNwLl9jb252ZXJzYXRpb247XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgaWYgKHJlc3AubWVzc2FnZSA9PT0gdW5kZWZpbmVkKXtcbiAgICAgICAgICAgIHBva2VUaGVSb2JvdCgpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBlbHNlIGlmIChuZXcgUmVnRXhwKGJhZFdvcmRzLmpvaW4oXCJ8XCIpKS50ZXN0KHJlc3AubWVzc2FnZSkgPT09IHRydWUpIHtcbiAgICAgICAgICAgIC8vIFRoZSByb2JvdCBpcyBzYXlpbmcgc29tZXRoaW5nIG9mZmVuc2l2ZSwgbGV0J3MgYXNrIGhpbSBhZ2FpbiFcbiAgICAgICAgICAgIGNvbnRhY3RUaGVSb2JvdChtZXNzYWdlKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgZWxzZXtcbiAgICAgICAgICAgIHJvYm90UmVzcG9uZChsZXNzQ2xldmVyKHJlc3AubWVzc2FnZSkpOyAgICAgICAgICAgIFxuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBjb25zb2xlLmxvZygnRVJST1InKTtcbiAgICAgICAgICBjb25zb2xlLmxvZyhyZXF1ZXN0LnJlc3BvbnNlVGV4dCk7XG4gICAgICAgICAgYWxlcnQoJ0VSUk9SOiAnICsgcmVxdWVzdC5yZXNwb25zZVRleHQgKyAnXFxuXFxuUGxlYXNlIGNvbnRhY3Qgc3RlZmFuQGZvdXJ0b25maXNoLmNvbS5cXG5cXG5UaGFua3MhJyk7XG4gICAgICAgIH1cbiAgICAgIH07XG5cbiAgICAgIHJlcXVlc3Qub25lcnJvciA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAvL1RPRE86IFRoZXJlIHdhcyBhIGNvbm5lY3Rpb24gZXJyb3Igb2Ygc29tZSBzb3J0XG4gICAgICB9O1xuICAvLyBCYWNrZW5kIGRvZXNuJ3Qgc3VwcG9ydCBkYXRhIGluIEpTT04gZm9ybWF0LCBrZWVwaW5nIHRoaXMgaGVyZSBmb3IgZnV0dXJlLlxuICAvKlxuICAgICAgdmFyIHBhcmFtZXRlcnMgPSB7XG4gICAgICAgIGluc3RhbmNlOiByb2JvdC5pZCxcbiAgICAgICAgYXBwbGljYXRpb246ICcxNTU1MjUwMzA0MTczMDA1OTUnLFxuICAgICAgICBtZXNzYWdlOiAnaGVsbG8nICAgICAgXG4gICAgICB9O1xuXG4gICAgICBpZiAocm9ib3QuY29udmVyc2F0aW9uSUQgIT09IG51bGwpe1xuICAgICAgICBwYXJhbWV0ZXJzWydjb252ZXJzYXRpb24nXSA9IHJvYm90LmNvbnZlcnNhdGlvbklEO1xuICAgICAgfVxuXG4gICAgICByZXF1ZXN0LnNldFJlcXVlc3RIZWFkZXIoXCJDb250ZW50LVR5cGVcIiwgXCJhcHBsaWNhdGlvbi9qc29uO2NoYXJzZXQ9VVRGLThcIik7XG4gICAgICByZXF1ZXN0LnNlbmQoSlNPTi5zdHJpbmdpZnkocGFyYW1ldGVycykpO1xuICAqLyAgICBcbiAgICAgIHJlcXVlc3Quc2VuZCgpO1xuXG4gICAgfVxuICAgIGVsc2V7XG4gICAgICBpZiAobWVzc2FnZS5pbmRleE9mKCc/JykgPiAtMSl7XG4gICAgICAgIGlmIChyb2JvdC5hbHJlYWR5QW5zd2VyZWRSZXNwb25zZXMubGVuZ3RoID4gMCl7XG4gICAgICAgICAgdmFyIGFubm95ZWRNZXNzYWdlID0gcm9ib3QuYWxyZWFkeUFuc3dlcmVkUmVzcG9uc2VzLnNwbGljZShnZXRSYW5kb21JbnQoMCwgcm9ib3QuYWxyZWFkeUFuc3dlcmVkUmVzcG9uc2VzLmxlbmd0aCAtIDEpLCAxKTtcbiAgICAgICAgICBhbm5veWVkTWVzc2FnZSA9IGFubm95ZWRNZXNzYWdlWzBdO1xuICAgICAgICAgIHJvYm90UmVzcG9uZChsZXNzQ2xldmVyKGFubm95ZWRNZXNzYWdlKSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZXtcbiAgICAgICAgICByb2JvdFJlc3BvbmQoJy4uLicpOyBcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIHBva2VUaGVSb2JvdCgpe1xuICAgIHZhciBzZW5kVGV4dCA9IFtcbiAgICAgICAgICBcIi4uLlwiXG4gICAgICAgIF07XG4gICAgY29udGFjdFRoZVJvYm90KHNlbmRUZXh0W2dldFJhbmRvbUludCgwLCBzZW5kVGV4dC5sZW5ndGggLSAxKV0pO1xuICB9XG5cbiAgZnVuY3Rpb24gcm9ib3RSZXNwb25kKG1lc3NhZ2Upe1xuICAgIG1lc3NhZ2UgPSBtZXNzYWdlLnJlcGxhY2UoLyhSb2JvdE5vdEltcG9zdG9yKFxcZCkqfEplbm55fGxpbmggdHJ1b25nfEFsaWNlKS9naSwgcm9ib3QubmFtZSk7XG4gICAgbWVzc2FnZSA9IG1lc3NhZ2UucmVwbGFjZSgvUk9CT1RGUk9NL2dpLCByb2JvdC5mcm9tKTtcbiAgICByb2JvdC5wZW5kaW5nUmVzcG9uc2VzLnB1c2gobWVzc2FnZSk7XG4gICAgaWYgKHJvYm90LnBlbmRpbmdSZXNwb25zZXMubGVuZ3RoID4gMCl7XG4gICAgICB2YXIgbmV4dE1lc3NhZ2UgPSByb2JvdC5wZW5kaW5nUmVzcG9uc2VzLnNoaWZ0KCksXG4gICAgICAgICAgbmV4dE1lc3NhZ2VMZW5ndGggPSBuZXh0TWVzc2FnZS5sZW5ndGgsXG4gICAgICAgICAgbmV4dE1lc3NhZ2VEZWxheSA9IChuZXh0TWVzc2FnZUxlbmd0aCAqIGdldFJhbmRvbUludCg1MCwgMTAwKSkgKyBnZXRSYW5kb21JbnQoMjAwMCwgODAwMCk7XG4gICAgICBpZiAocm9ib3QucmVzcG9uc2VQZW5kaW5nID09PSBmYWxzZSl7XG4gICAgICAgIHJvYm90LnJlc3BvbnNlUGVuZGluZyA9IHRydWU7XG4gICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKXtcbiAgICAgICAgICBhZGRNZXNzYWdlKCdyb2JvdCcsIG1lc3NhZ2UpO1xuICAgICAgICAgIHJvYm90LnJlc3BvbnNlUGVuZGluZyA9IGZhbHNlO1xuICAgICAgICB9LCBuZXh0TWVzc2FnZURlbGF5KTtcbiAgICAgIH1cbiAgICAgIGVsc2V7XG4gICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKXtcbiAgICAgICAgICByZXR1cm4gKGZ1bmN0aW9uKG1lc3NhZ2Upe1xuICAgICAgICAgICAgcm9ib3RSZXNwb25kKG1lc3NhZ2UpOyAgICAgICAgICAgIFxuICAgICAgICAgIH0pKG1lc3NhZ2UpO1xuICAgICAgICB9LCAxMDAwKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiByZXZlYWxJbXBvc3RvcihkZXRlY3RpdmVHdWVzcyl7XG4gICAgaWYgKHBhcnRuZXJSb2xlICE9PSAndW5rbm93bicpe1xuICAgICAgZ2FtZUZpbmlzaGVkID0gdHJ1ZTtcbiAgICAgIGlmIChkZXRlY3RpdmVHdWVzcyA9PT0gcGFydG5lclJvbGUpe1xuICAgICAgICBhZGRNZXNzYWdlKCdzeXN0ZW0nLCAnQ09SUkVDVCcpO1xuICAgICAgICBnbG9iYWxTb2NrZXQuZW1pdCgnZ2FtZSBvdmVyJywgJ2RldGVjdGl2ZSB3b24nKTtcbiAgICAgIH1cbiAgICAgIGVsc2V7XG4gICAgICAgIGFkZE1lc3NhZ2UoJ3N5c3RlbScsICdJTkNPUlJFQ1QnKTtcbiAgICAgICAgZ2xvYmFsU29ja2V0LmVtaXQoJ2dhbWUgb3ZlcicsICdkZXRlY3RpdmUgbG9zdCcpO1xuICAgICAgfVxuICAgICAgYWRkTWVzc2FnZSgnc3lzdGVtJywgJ0dhbWUgaXMgb3ZlcicpO1xuICAgICAgc2hvd1NoYXJpbmdCdXR0b25zKCk7XG4gICAgfVxuICAgIGVsc2V7XG4gICAgICBhZGRNZXNzYWdlKCdzeXN0ZW0nLCAnRVJST1InKTtcbiAgICAgIGFkZE1lc3NhZ2UoJ3N5c3RlbScsICdUb28gZWFybHkgdG8gdGVsbCcpO1xuICAgIH1cbiAgICAvL1RPRE86IEltcGxlbWVudCBzY29yaW5nIHN5c3RlbS5cbiAgfVxuXG4gIGZ1bmN0aW9uIGFkZE1lc3NhZ2UobWVzc2FnZUZyb20sIG1lc3NhZ2VUZXh0KXtcbiAgICBpZiAobWVzc2FnZVRleHQudHJpbSgpLmxlbmd0aCA9PT0gMCl7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIHZhciBuZXdNZXNzYWdlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcIkxJXCIpO1xuICAgIHN3aXRjaCAobWVzc2FnZUZyb20pe1xuICAgICAgY2FzZSAndXNlcic6XG4gICAgICAgIG5ld01lc3NhZ2UuY2xhc3NMaXN0LmFkZCgndXNlci1tZXNzYWdlJyk7XG4gICAgICAgIG5ld01lc3NhZ2UuY2xhc3NMaXN0LmFkZCgnbmV3LW1lc3NhZ2UnKTtcbiAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAnc3lzdGVtJzpcbiAgICAgICAgbmV3TWVzc2FnZS5jbGFzc0xpc3QuYWRkKCdzeXN0ZW0tbWVzc2FnZScpO1xuICAgICAgICBzd2l0Y2ggKG1lc3NhZ2VUZXh0KXtcbiAgICAgICAgICBjYXNlICdFUlJPUic6XG4gICAgICAgICAgY2FzZSAnSU5DT1JSRUNUJzpcbiAgICAgICAgICAgIG5ld01lc3NhZ2UuY2xhc3NMaXN0LmFkZCgnZXJyb3ItbWVzc2FnZScpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIGNhc2UgJ0NPUlJFQ1QnOlxuICAgICAgICAgICAgbmV3TWVzc2FnZS5jbGFzc0xpc3QuYWRkKCd1c2VyLWNvcnJlY3QnKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgbmV3TWVzc2FnZS5jbGFzc0xpc3QuYWRkKCduZXctbWVzc2FnZScpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICBicmVhaztcbiAgICAgIGNhc2UgJ3JvYm90JzpcbiAgICAgIGNhc2UgJ2ltcG9zdG9yJzpcbiAgICAgICAgbmV3TWVzc2FnZS5jbGFzc0xpc3QuYWRkKCdyb3JpLW1lc3NhZ2UnKTtcbiAgICAgICAgbmV3TWVzc2FnZS5jbGFzc0xpc3QuYWRkKCduZXctbWVzc2FnZScpO1xuICAgICAgYnJlYWs7XG4gICAgfVxuXG4gICAgLypcbiAgICAgIEZ1biBzdHVmZiAtLSBwYXJ0IG9uZSEgI2Vhc3RlcmVnZ3NcbiAgICAqL1xuXG4gICAgdmFyIGZ1blN0dWZmID0gY2xlYXJUZXh0KG1lc3NhZ2VUZXh0LCB0cnVlKTtcblxuICAgIGlmIChmdW5TdHVmZi5pbmRleE9mKCd3aWdnbGUnKSA+IC0xKXtcbiAgICAgIG5ld01lc3NhZ2UuY2xhc3NMaXN0LmFkZCgnd2lnZ2xlLW1lc3NhZ2UnKTsgICAgICAgIFxuICAgIH1cblxuICAgIGlmIChmdW5TdHVmZi5pbmRleE9mKCdqdW1wJykgPiAtMSl7XG4gICAgICBuZXdNZXNzYWdlLmNsYXNzTGlzdC5hZGQoJ2p1bXAtbWVzc2FnZScpOyAgICAgICAgXG4gICAgfVxuXG4gICAgbmV3TWVzc2FnZS5pbm5lckhUTUwgPSBtZXNzYWdlVGV4dC5yZXBsYWNlKC8oPChbXj5dKyk+KS9pZyxcIlwiKTtcbiAgICAvL1RPRE86IFJld3JpdGUgdGhpcyFcblxuICAgIGlmIChtZXNzYWdlRnJvbSAhPT0gJ3VzZXInICYmIG1lc3NhZ2VGcm9tICE9PSAnc3lzdGVtJyl7XG4gICAgICBuZXdNZXNzYWdlLmlubmVySFRNTCA9ICc8c3BhbiBjbGFzcz1cIm1lc3NhZ2UtcHJlcGVuZFwiPj48L3NwYW4+ICcgKyBuZXdNZXNzYWdlLmlubmVySFRNTDtcbiAgICB9XG5cbiAgICBpZiAobWVzc2FnZVRleHQgPT09ICdHYW1lIGlzIG92ZXInICYmIG1lc3NhZ2VGcm9tID09PSAnc3lzdGVtJyl7XG4gICAgICBuZXdNZXNzYWdlLmlubmVySFRNTCArPSAnPHAgc3R5bGU9XCJjb2xvcjogI2ZmZiAhaW1wb3J0YW50O1wiPlBTOiBUaGlzIGdhbWUgaXMgbm93IDxhIHRhcmdldD1cIl9ibGFua1wiIGhyZWY9XCJodHRwczovL2dpdGh1Yi5jb20vYm90d2lraS9kZXRlY3RpdmUvXCI+b3BlbiBzb3VyY2U8L2E+ITwvcD4nO1xuICAgIH1cblxuXG4gICAgaWYgKG1lc3NhZ2VGcm9tID09PSAncm9ib3QnICYmIGdhbWVGaW5pc2hlZCA9PT0gdHJ1ZSl7XG4gICAgICAvLyBudWxsXG4gICAgfVxuICAgIGVsc2V7XG4gICAgICBtZXNzYWdlcy5hcHBlbmRDaGlsZChuZXdNZXNzYWdlKTtcblxuICAgICAgLypcbiAgICAgICAgRnVuIHN0dWZmIC0tIHBhcnQgdHdvISAjZWFzdGVyZWdnc1xuICAgICAgKi9cbiAgICAgIHN3aXRjaChjbGVhclRleHQobWVzc2FnZVRleHQsIHRydWUpKXtcbiAgICAgICAgY2FzZSAnaWxpa2V0aGlzZ2FtZSc6XG4gICAgICAgICAgYWRkTWVzc2FnZSgnc3lzdGVtJywgJ09oIGhleSwgdGhhbmtzIScpO1xuICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAnZ29kbW9kZSc6XG4gICAgICAgICAgYWRkTWVzc2FnZSgnc3lzdGVtJywgJ05vdCBpbiB0aGlzIGdhbWUuJyk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuXG4gICAgfVxuICAgIGlmIChtZXNzYWdlRnJvbSA9PT0gJ3VzZXInKXtcbiAgICAgIG1lc3NhZ2VUZXh0SW5wdXQudmFsdWUgPSAnJztcbiAgICB9XG4gICAgZWxzZXtcbiAgICAgIGlmICghZG9jdW1lbnQuaGFzRm9jdXMoKSl7XG4gICAgICAgIGRvY3VtZW50LnRpdGxlID0gJ05ldyBtZXNzYWdlIHwgRGV0ZWN0aXZlIGJ5IEBmb3VydG9uZmlzaCc7XG4gICAgICB9XG4gICAgfVxuXG4gICAgZG9jdW1lbnQuYm9keS5zY3JvbGxUb3AgPSBkb2N1bWVudC5ib2R5LnNjcm9sbEhlaWdodDtcblxuICAgIHdpbmRvdy5zY3JvbGxUbygwLGRvY3VtZW50LmJvZHkuc2Nyb2xsSGVpZ2h0KTtcblxuXG4gICAgbWVzc2FnZVRleHQgPSBjbGVhclRleHQobWVzc2FnZVRleHQsIGZhbHNlKTtcblxuXG4gICAgaWYgKG1lc3NhZ2VGcm9tID09PSAndXNlcicgJiYgL3lvdS4qcmU/LiooaW1wb3N0b3J8aW1wb3N0ZXJ8cm9ib3R8Ym90KS9naS50ZXN0KG1lc3NhZ2VUZXh0KSAmJiB1c2VyUm9sZSA9PT0gJ2RldGVjdGl2ZScgJiYgZ2FtZUZpbmlzaGVkID09PSBmYWxzZSAmJiBtZXNzYWdlVGV4dC5pbmRleE9mKCdub3QnKSA9PT0gLTEpe1xuICAgICAgY29uc29sZS5sb2cobWVzc2FnZVRleHQpO1xuXG4gICAgICBpZiAobmV3IFJlZ0V4cChbJ3lvdWFyZWFyb2JvdCcsXG4gICAgICAgICAgICAgICAgICAgICAgJ3lvdVxcJ3JlYXJvYm90JyxcbiAgICAgICAgICAgICAgICAgICAgICAneW91YXJlcm9ib3QnLFxuICAgICAgICAgICAgICAgICAgICAgICd5b3VyZXJvYm90JyxcbiAgICAgICAgICAgICAgICAgICAgICAneW91cmVhcm9ib3QnLFxuICAgICAgICAgICAgICAgICAgICAgICd5b3VcXCdyZXJvYm90JyxcbiAgICAgICAgICAgICAgICAgICAgICAneW91YXJldGhlcm9ib3QnLFxuICAgICAgICAgICAgICAgICAgICAgICd5b3VcXCdyZXRoZXJvYm90J1xuICAgICAgICAgICAgICAgICAgICBdLmpvaW4oXCJ8XCIpKS50ZXN0KG1lc3NhZ2VUZXh0KSA9PT0gdHJ1ZSkge1xuICAgICAgICByZXZlYWxJbXBvc3Rvcigncm9ib3QnKTtcbiAgICAgIH1cbiAgICAgIGVsc2UgaWYgKG5ldyBSZWdFeHAoWyd5b3VhcmVhbmltcG9zdGVyJyxcbiAgICAgICAgICAgICAgICAgICAgICAneW91YXJlYW5pbXBvc3RvcicsXG4gICAgICAgICAgICAgICAgICAgICAgJ3lvdVxcJ3JlYW5pbXBvc3RlcicsXG4gICAgICAgICAgICAgICAgICAgICAgJ3lvdVxcJ3JlYW5pbXBvc3RvcicsXG4gICAgICAgICAgICAgICAgICAgICAgJ3lvdWFyZWltcG9zdGVyJyxcbiAgICAgICAgICAgICAgICAgICAgICAneW91YXJlaW1wb3N0b3InLFxuICAgICAgICAgICAgICAgICAgICAgICd5b3VcXCdyZWltcG9zdGVyJyxcbiAgICAgICAgICAgICAgICAgICAgICAneW91XFwncmVpbXBvc3RvcicsXG4gICAgICAgICAgICAgICAgICAgICAgJ3lvdXJldGhlaW1wb3N0ZXInLFxuICAgICAgICAgICAgICAgICAgICAgICd5b3VyZXRoZWltcG9zdG9yJyxcbiAgICAgICAgICAgICAgICAgICAgICAneW91cmVpbXBvc3RlcicsXG4gICAgICAgICAgICAgICAgICAgICAgJ3lvdXJlaW1wb3N0b3InLFxuICAgICAgICAgICAgICAgICAgICAgICd5b3VyZWFuaW1wb3N0ZXInLFxuICAgICAgICAgICAgICAgICAgICAgICd5b3VyZWFuaW1wb3N0b3InLFxuICAgICAgICAgICAgICAgICAgICAgICd5b3VhcmV0aGVpbXBvc3RlcicsXG4gICAgICAgICAgICAgICAgICAgICAgJ3lvdWFyZXRoZWltcG9zdG9yJyxcbiAgICAgICAgICAgICAgICAgICAgICAneW91XFwncmV0aGVpbXBvc3RlcicsXG4gICAgICAgICAgICAgICAgICAgICAgJ3lvdVxcJ3JldGhlaW1wb3N0b3InXG4gICAgICAgICAgICAgICAgICAgIF0uam9pbihcInxcIikpLnRlc3QobWVzc2FnZVRleHQpID09PSB0cnVlKSB7XG4gICAgICAgcmV2ZWFsSW1wb3N0b3IoJ2ltcG9zdG9yJyk7XG4gICAgICB9IFxuICAgICAgZWxzZXtcbiAgICAgICAgYWRkTWVzc2FnZSgnc3lzdGVtJywgJ1BsZWFzZSBzYXkgXCJZb3UgYXJlIGEgcm9ib3RcIiBvciBcIllvdSBhcmUgYW4gaW1wb3N0b3JcIi4nKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcImZvY3VzXCIsIGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgaWYgKHVzZXJSb2xlICE9PSB1bmRlZmluZWQpe1xuICAgICAgZG9jdW1lbnQudGl0bGUgPSAnWW91IGFyZSB0aGUgJyArIHVzZXJSb2xlICsgJyB8IERldGVjdGl2ZSBieSBAZm91cnRvbmZpc2gnO1xuICAgIH1cbiAgfSwgZmFsc2UpO1xuXG4gIHZhciBzb2NrZXQ7XG5cbiAgaWYgKHByb2R1Y3Rpb25TZXJ2ZXIoKSl7XG4gICAgc29ja2V0ID0gaW8oZG9jdW1lbnQubG9jYXRpb24ucHJvdG9jb2wgKyAnLy9mb3VydG9uZmlzaC5jb206MzAwMycpO1xuICB9XG4gIGVsc2V7XG4gICAgc29ja2V0ID0gaW8oZG9jdW1lbnQubG9jYXRpb24ucHJvdG9jb2wgKyAnLy8nICsgZG9jdW1lbnQubG9jYXRpb24uaG9zdCk7XG4gIH1cblxuICBpZiAoZGlzbWlzc0luc3RydWN0aW9uc0J1dHRvbil7XG4gICAgZGlzbWlzc0luc3RydWN0aW9uc0J1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKCl7XG4gICAgICBpZiAocGFydG5lclJvbGUgPT09ICdyb2JvdCcpe1xuICAgICAgICByZXN0YXJ0R2xvYmFsVGltZXIoKTtcbiAgICAgIH1cbiAgICAgIGluc3RydWN0aW9uc1dyYXBwZXIuY2xhc3NMaXN0LmFkZCgnc2hpZnRlZFVwJyk7XG4gICAgICBtZXNzYWdlRm9ybS5jbGFzc0xpc3QucmVtb3ZlKCdoaWRkZW4nKTtcbiAgICAgIG1vcmVJbmZvLmNsYXNzTGlzdC5yZW1vdmUoJ2hpZGRlbicpO1xuICAgICAgbW9yZUluZm8uY2xhc3NMaXN0LnJlbW92ZSgnc2hpZnRlZCcpO1xuICAgICAgbWVzc2FnZVRleHRJbnB1dC5mb2N1cygpO1xuICAgIH0pO1xuICB9XG5cbiAgLy8gaWYgKHJlcXVlc3ROb3RpZmljYXRpb25QZXJtaXNzaW9uKXtcbiAgLy8gICByZXF1ZXN0Tm90aWZpY2F0aW9uUGVybWlzc2lvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKCl7XG4gIC8vICAgICBOb3RpZmljYXRpb24ucmVxdWVzdFBlcm1pc3Npb24oZnVuY3Rpb24gKHBlcm1pc3Npb24pIHtcbiAgLy8gICAgIGNvbnNvbGUubG9nKHBlcm1pc3Npb24pO1xuICAvLyAgICAgfSk7XG4gIC8vICAgfSk7XG4gIC8vIH1cblxuICBpZiAoc2hhcmVDaGF0TG9nTW9kdWxlLnRyaWdnZXJFbCl7XG4gICAgc2hhcmVDaGF0TG9nTW9kdWxlLnRyaWdnZXJFbC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKGV2KXtcbiAgICAgIGV2LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICBzaGFyZVRhcmdldCA9IGdldEV2ZW50VGFyZ2V0KGV2KTtcblxuICAgICAgc3dpdGNoIChzaGFyZVRhcmdldC5nZXRBdHRyaWJ1dGUoJ2RhdGEtdXJsJykpe1xuICAgICAgICBjYXNlICdSRUxPQUQnOlxuICAgICAgICAgIGxvY2F0aW9uLnJlbG9hZCgpO1xuICAgICAgICBicmVhaztcbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICBpZiAoc2hhcmVDaGF0TG9nTW9kdWxlLnNoYXJlVXJsID09PSBudWxsKXtcbiAgICAgICAgICAgIHNoYXJlQ2hhdExvZ01vZHVsZS5zdGF0dXMuaW5uZXJIVE1MID0gJ0xvYWRpbmcuLi4nO1xuICAgICAgICAgICAgZ2xvYmFsU29ja2V0LmVtaXQoJ3NhdmVfY2hhdF9sb2cnLCBtZXNzYWdlc1dyYXBwZXIuaW5uZXJIVE1MLCB1c2VyUm9sZSk7ICAgICBcbiAgICAgICAgICB9XG4gICAgICAgICAgZWxzZXtcbiAgICAgICAgICAgIHNoYXJlQ2hhdExvZygpO1xuICAgICAgICAgIH1cbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuICBpZiAoc2hpZnRlZEVsczEubGVuZ3RoID4gMCl7XG4gICAgQXJyYXkucHJvdG90eXBlLmZvckVhY2guY2FsbChzaGlmdGVkRWxzMSwgZnVuY3Rpb24oZWwsIGluZGV4KSB7XG4gICAgICBzZXRUaW1lb3V0KFxuICAgICAgICBmdW5jdGlvbigpe1xuICAgICAgICAgIGVsLmNsYXNzTGlzdC5yZW1vdmUoJ3NoaWZ0ZWQtMScpO1xuICAgICAgICAgIGVsLmNsYXNzTGlzdC5hZGQoJ3Vuc2hpZnRlZC0xJyk7XG4gICAgICAgIH0sXG4gICAgICAgICgyMDAtKDEwKmluZGV4KSkqaW5kZXgpO1xuICAgIH0pO1xuICB9ICBcblxuICBzb2NrZXQub24oJ2Nvbm5lY3RlZCcsIGZ1bmN0aW9uKGRhdGEpIHtcbiAgICBnbG9iYWxTb2NrZXQgPSBzb2NrZXQ7XG4gIH0pO1xuXG4gIHNvY2tldC5vbignY2hhdF9sb2dfc2F2ZWQnLCBmdW5jdGlvbihkYXRhKSB7XG4gICAgY29uc29sZS5sb2coJ2NoYXQgbG9nIHNhdmVkJyk7XG4gICAgc2hhcmVDaGF0TG9nTW9kdWxlLmNoYXRMb2dJZCA9IGRhdGE7XG4gICAgc2hhcmVDaGF0TG9nKCk7XG4gIH0pO1xuXG4gIHNvY2tldC5vbignZXJyb3InLCBmdW5jdGlvbihkYXRhKSB7XG4gICAgY29uc29sZS5sb2coJ0VSUk9SJyk7XG4gICAgY29uc29sZS5sb2coZGF0YSk7XG4gIH0pO1xuXG4gIHNvY2tldC5vbignZ2FtZSBvdmVyJywgZnVuY3Rpb24oc3RhdHVzKSB7XG4gICAgaWYgKHN0YXR1cyA9PT0gJ2RldGVjdGl2ZSB3b24nKXtcbiAgICAgIGFkZE1lc3NhZ2UoJ3N5c3RlbScsICdZT1UgSEFWRSBCRUVOIFJFVkVBTEVEJyk7XG4gICAgfVxuICAgIGVsc2V7XG4gICAgICBhZGRNZXNzYWdlKCdzeXN0ZW0nLCAnWU9VIEZPT0xFRCBUSEUgREVURUNUSVZFJyk7ICAgICAgXG4gICAgfVxuICAgIGFkZE1lc3NhZ2UoJ3N5c3RlbScsICdHYW1lIGlzIG92ZXInKTtcbiAgICBzaG93U2hhcmluZ0J1dHRvbnMoKTtcbiAgfSk7XG5cbiAgc29ja2V0Lm9uKCdwYXJ0bmVyIGRpc2Nvbm5lY3RlZCcsIGZ1bmN0aW9uKGRhdGEpIHtcbiAgICBhZGRNZXNzYWdlKCdzeXN0ZW0nLCAnUGFydG5lciBkaXNjb25uZWN0ZWQuJyk7XG4gICAgc2hvd1NoYXJpbmdCdXR0b25zKCk7XG4gICAgY29uc29sZS5sb2coJ1BhcnRuZXIgZGlzY29ubmVjdGVkOiAnICsgZGF0YSArICcuJyk7XG5cbiAgICBpZiAoZGF0YSA9PT0gJ3BpbmcgdGltZW91dCcpe1xuICAgICAgLy9UT0RPOiBXYXMgdGhpcyBhIGJvdD9cbiAgICB9XG4gICAgaWYgKHBhcnRuZXJSb2xlICE9PSAndW5rbm93bicgJiYgdXNlclJvbGUgPT09ICdkZXRlY3RpdmUnICYmIGdhbWVGaW5pc2hlZCA9PT0gZmFsc2Upe1xuICAgICAgYWRkTWVzc2FnZSgnc3lzdGVtJywgJ1lvdSB3ZXJlIHNwZWFraW5nIHdpdGggdGhlICcgKyBwYXJ0bmVyUm9sZS50b1VwcGVyQ2FzZSgpICsgJy4nKTtcbiAgICB9XG4gIH0pO1xuXG4gIHNvY2tldC5vbigneW91IGFyZScsIGZ1bmN0aW9uKGRhdGEpIHtcbiAgICBnYW1lU3RhcnRlZCA9IHRydWU7XG4gICAgY2xlYXJUaW1lb3V0KGdsb2JhbFRpbWVyV2FpdGluZyk7XG4gICAgdXNlclJvbGUgPSBkYXRhO1xuICAgIGxvYWRpbmdJbmRpY2F0b3IuY2xhc3NMaXN0LmFkZCgnc2hpZnRlZFVwJyk7XG4gICAgdmFyIHVuc2hpZnRlZEVsczEgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCd1bnNoaWZ0ZWQtMScpXG5cbiAgICBpZiAodW5zaGlmdGVkRWxzMS5sZW5ndGggPiAwKXtcbiAgICAgIEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwodW5zaGlmdGVkRWxzMSwgZnVuY3Rpb24oZWwsIGluZGV4KSB7XG4gICAgICAgIHNldFRpbWVvdXQoXG4gICAgICAgICAgZnVuY3Rpb24oKXtcbiAgICAgICAgICAgIGVsLmNsYXNzTGlzdC5yZW1vdmUoJ3Vuc2hpZnRlZC0xJyk7XG4gICAgICAgICAgICBlbC5jbGFzc0xpc3QuYWRkKCdzaGlmdGVkVXAxJyk7XG4gICAgICAgICAgfSxcbiAgICAgICAgICAoMjAwLSgxMCppbmRleCkpKmluZGV4KTtcbiAgICAgIH0pO1xuICAgIH1cblxuXG5cbiAgICBpZiAoc2hpZnRlZEVscy5sZW5ndGggPiAwKXtcbiAgICAgIEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwoc2hpZnRlZEVscywgZnVuY3Rpb24oZWwsIGluZGV4KSB7XG4gICAgICAgIHNldFRpbWVvdXQoXG4gICAgICAgICAgZnVuY3Rpb24oKXtcbiAgICAgICAgICAgIGVsLmNsYXNzTGlzdC5yZW1vdmUoJ3NoaWZ0ZWQnKTtcbiAgICAgICAgICAgIGVsLmNsYXNzTGlzdC5hZGQoJ3Vuc2hpZnRlZCcpO1xuICAgICAgICAgIH0sXG4gICAgICAgICAgKDIwMC0oMTAqaW5kZXgpKSppbmRleCk7XG4gICAgICB9KTtcbiAgICB9XG4vLyAgICB3aGF0SXNUaGlzTGluay5jbGFzc0xpc3QuYWRkKCdzaGlmdGVkVXAnKTtcbiAgICBkaXNtaXNzSW5zdHJ1Y3Rpb25zQnV0dG9uLmZvY3VzKCk7XG4gICAgZG9jdW1lbnQudGl0bGUgPSAnWW91IGFyZSB0aGUgJyArIHVzZXJSb2xlICsgJyB8IERldGVjdGl2ZSBieSBAZm91cnRvbmZpc2gnO1xuICAgIHJvbGVSZW1pbmRlci5pbm5lckhUTUwgPSAndGhlIDxzcGFuIGNsYXNzPVwiaGlnaGxpZ2h0XCI+JyArIHVzZXJSb2xlICsgJzwvc3Bhbj4nO1xuICAgIHlvdUFyZS5pbm5lckhUTUwgPSAnWW91IGFyZSB0aGUgPHNwYW4gY2xhc3M9XCJoaWdobGlnaHRcIj4nICsgdXNlclJvbGUgKyAnPC9zcGFuPic7XG4gICAgaWYgKHVzZXJSb2xlID09PSAnZGV0ZWN0aXZlJyl7XG4gICAgICBpbnN0cnVjdGlvbnMuaW5uZXJIVE1MID0gJzxwPllvdSBtdXN0IGZpZ3VyZSBvdXQgd2hldGhlciB5b3UgYXJlIHNwZWFraW5nIHRvIGEgPHNwYW4gY2xhc3M9XCJoaWdobGlnaHRcIj5ST0JPVDwvc3Bhbj4qIG9yIGFuIDxzcGFuIGNsYXNzPVwiaGlnaGxpZ2h0XCI+SU1QT1NUT1I8L3NwYW4+LCBhbm90aGVyIHBsYXllciBwcmV0ZW5kaW5nIHRvIGJlIGEgPHNwYW4gY2xhc3M9XCJoaWdobGlnaHRcIj5ST0JPVDwvc3Bhbj4qLjwvcD4nICtcbiAgICAgICAgJzxwPlNheSA8ZW0+XCJZb3UgYXJlIGFuIGltcG9zdG9yXCI8L2VtPiBvciA8ZW0+XCJZb3UgYXJlIGEgcm9ib3RcIjwvZW0+IG9uY2UgeW91IGFyZSBjb25maWRlbnQgd2l0aCB5b3VyIGNob2ljZS48L3A+JyArXG4gICAgICAgICc8cCBjbGFzcz1cImRlZmluaXRpb25cIj4qQSA8YSBocmVmPVwiaHR0cDovL2VuLndpa2lwZWRpYS5vcmcvd2lraS9DaGF0Ym90XCIgdGFyZ2V0PVwiX2JsYW5rXCI+Y2hhdHRlciByb2JvdDwvYT4gaXMgYSB0eXBlIG9mIGNvbnZlcnNhdGlvbmFsIGFnZW50LCBhIGNvbXB1dGVyIHByb2dyYW0gZGVzaWduZWQgdG8gc2ltdWxhdGUgYW4gaW50ZWxsaWdlbnQgY29udmVyc2F0aW9uIHdpdGggb25lIG9yIG1vcmUgaHVtYW4gdXNlcnMgdmlhIGF1ZGl0b3J5IG9yIHRleHR1YWwgbWV0aG9kcy48L3A+JztcbiAgICB9XG4gICAgZWxzZXtcbiAgICAgIGluc3RydWN0aW9ucy5pbm5lckhUTUwgPSAnPHA+WW91IG11c3QgY29udmluY2UgdGhlIDxzcGFuIGNsYXNzPVwiaGlnaGxpZ2h0XCI+REVURUNUSVZFPC9zcGFuPiB0aGF0IGhlIG9yIHNoZSBpcyBzcGVha2luZyB0byBhIDxzcGFuIGNsYXNzPVwiaGlnaGxpZ2h0XCI+Uk9CT1Q8L3NwYW4+Ki48L3A+JyArIFxuICAgICAgJzxwIGNsYXNzPVwiZGVmaW5pdGlvblwiPipBIDxhIGhyZWY9XCJodHRwOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL0NoYXRib3RcIiB0YXJnZXQ9XCJfYmxhbmtcIj5jaGF0dGVyIHJvYm90PC9hPiBpcyBhIHR5cGUgb2YgY29udmVyc2F0aW9uYWwgYWdlbnQsIGEgY29tcHV0ZXIgcHJvZ3JhbSBkZXNpZ25lZCB0byBzaW11bGF0ZSBhbiBpbnRlbGxpZ2VudCBjb252ZXJzYXRpb24gd2l0aCBvbmUgb3IgbW9yZSBodW1hbiB1c2VycyB2aWEgYXVkaXRvcnkgb3IgdGV4dHVhbCBtZXRob2RzLjwvcD4nOyAgICAgIFxuICAgIH1cbiAgfSk7XG5cbiAgc29ja2V0Lm9uKCdwYWlyZWQnLCBmdW5jdGlvbihkYXRhKSB7XG4gICAgaWYgKGRhdGEudXNlcnNbMF0gPT09ICdyb2JvdCcgfHwgZGF0YS51c2Vyc1sxXSA9PT0gJ3JvYm90Jyl7XG4gICAgICBwYXJ0bmVyUm9sZSA9ICdyb2JvdCc7XG4gICAgICBzZW5kTWVzc2FnZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKGV2ZW50KXtcbiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgaWYgKGNvbnRhaW5zT2ZmZW5zaXZlTGFuZ3VhZ2UoY2xlYXJUZXh0KG1lc3NhZ2VUZXh0SW5wdXQudmFsdWUsIHRydWUpKSA9PT0gZmFsc2Upe1xuICAgICAgICAgIHJlc3RhcnRHbG9iYWxUaW1lcigpO1xuICAgICAgICAgIGlmIChnYW1lRmluaXNoZWQgPT09IGZhbHNlKXtcbiAgICAgICAgICAgIGNvbnRhY3RUaGVSb2JvdChtZXNzYWdlVGV4dElucHV0LnZhbHVlKTtcbiAgICAgICAgICAgIGFkZE1lc3NhZ2UoJ3VzZXInLCBtZXNzYWdlVGV4dElucHV0LnZhbHVlKTsgICAgICAgICAgXG4gICAgICAgICAgfVxuICAgICAgICAgIGVsc2V7XG4gICAgICAgICAgICBhbGVydCgnTGV0XFwncyBnaXZlIHRoZSByb2JvdCBzb21lIHJlc3QuJyk7XG4gICAgICAgICAgfSAgICAgICAgICBcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuICAgIGVsc2V7XG4gICAgICBwYXJ0bmVyUm9sZSA9ICh1c2VyUm9sZSA9PT0gJ2RldGVjdGl2ZScgPyAnaW1wb3N0b3InIDogJ2RldGVjdGl2ZScpO1xuXG4gICAgICBzZW5kTWVzc2FnZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKGV2ZW50KXtcbiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgaWYgKGNvbnRhaW5zT2ZmZW5zaXZlTGFuZ3VhZ2UoY2xlYXJUZXh0KG1lc3NhZ2VUZXh0SW5wdXQudmFsdWUsIHRydWUpKSA9PT0gZmFsc2Upe1xuICAgICAgICAgIHNvY2tldC5lbWl0KCdzZW5kIG1lc3NhZ2UnLCB7XG4gICAgICAgICAgICAgIGZyb206IHVzZXJSb2xlLFxuICAgICAgICAgICAgICBtZXNzYWdlOiBtZXNzYWdlVGV4dElucHV0LnZhbHVlXG4gICAgICAgICAgICB9XG4gICAgICAgICAgKTtcbiAgICAgICAgICBhZGRNZXNzYWdlKCd1c2VyJywgbWVzc2FnZVRleHRJbnB1dC52YWx1ZSk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cblxuICB9KTtcblxuICBzb2NrZXQub24oJ21lc3NhZ2UgcmVjZWl2ZWQnLCBmdW5jdGlvbihkYXRhKSB7XG4gICAgaWYgKHBhcnRuZXJSb2xlID09PSAndW5rbm93bicpe1xuICAgICAgcGFydG5lclJvbGUgPSBkYXRhLmZyb207XG4gICAgfVxuICAgIGlmIChkYXRhLmZyb20gIT09IHVzZXJSb2xlKXtcbiAgICAgIGFkZE1lc3NhZ2UocGFydG5lclJvbGUsIGRhdGEubWVzc2FnZSk7XG4gICAgfVxuICB9KTtcbn0pO1xuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9